[["index.html", "Introduction aux Data Sciences Chapitre 1 Préface", " Introduction aux Data Sciences Christophe Benavent - Université Paris Dauphine 2021-08-12 Chapitre 1 Préface Ce bookdown reprend les éléments dun cours de data science avec r. Il a pour but dêtre reproductible, cest pourquoi le choix de ce support et des jeux de données associés. Il sera dynamique, modifié à mesure de nos cours, séminaires et ateliers. Lillustration représente lévolution de la longueur des films de la base Imbd et raconte en chiffres une part de lhistoire du cinema. Jusquau années la longueur est hétérogène mais au tournant des années 30, la distribution se stabilise, les court-métragessont de lordre de 15mn, et voient leurs durée se raccourcir avec les décénnies, le genre menace de disparaitredans les années 80 et reprend du poil de la bête dans les années 2000. Les films longs voient leur longueur saccroitre et se stabiliser autur de un peu moins de 100 mn, soit une heure et trente minutes. On observera enfin quau cours des années 1990 les film de taille intermédiaires réapparaissent. Dans ce graphique il y a tous les éléments des data sciences modernes : un jeu de donnée riche et systématique, un modèle statistique fondamentale avec la notion de densité de probabilité, une mesure, un critère de comparaison. Les diagrammes ridges sont inspirée de la pochette de lalbum Unknown Pleasures de Joy division sorti en pleine New Wave , en 1979. Un article de Vice en rappele lorigine et le destin de ce graphisme "],["plan-et-outils-du-manuel.html", "Chapitre 2 Plan et outils du manuel 2.1 Les jeux de données 2.2 Le cadre technique 2.3 A faire", " Chapitre 2 Plan et outils du manuel 1 - Lenvironnement r et python 2 - Installation et prise en main 3 - Usage de ggplot - uni et bivarié 4 - Usage de ggplot - multivarié 4 - Tables 5 - AFC 6 - Clustering 7 - Analyse de variance et régression linéraire 8 - Modèles factoriels 9 - Modèles déquations structurelles 10 - Modèles linéaire généralisé 11 - Modèles à décomposition derreur 12 - Times series 13 - Analyse geospatiale 2.1 Les jeux de données Au cours du développement, plusieurs cas pratiques - souvent réduit en volume pour rester exemplaires, seront employés. Les donées seront partagées. En voici la présentation systématique. disponibles dans le repositery avec le code du book. Les amendements et améliorations sont souhaitées et attendues. 2.2 Le cadre technique Ce livre est écrit en Markdown (Allaire et al. 2021) et avec le package Bookdown (Xie 2021) Le code sappuie très largement sur tidyverse et emploie largement les ressources de ggplot . Les packages seront introduits au fur et à mesure. En voici la liste complète. options(tinytex.verbose = TRUE) knitr::opts_chunk$set(echo = TRUE, include=TRUE, cache=TRUE, message=FALSE, warning=FALSE, cache=TRUE) #boite à outils et viz library(tidyverse) # inclut ggplot pour la viz, readr et library(cowplot) #pour créer des graphiques composés library(ggridges) # le joy division touch library(ggmosaic) library(citr) #networks library(igraph) library(ggraph) # Accéder aux données library(rtweet) # une interface efficace pour interroger l&#39;api de Twitter # NLP library(tokenizers) library(quanteda) library(quanteda.textstats) library(udpipe) #annotation syntaxique library(tidytext) library(cleanNLP) #annotation syntaxique #sentiment library(syuzhet) #analyse du sentimeent #mise en page des tableaux library(flextable) #statistiques et modèles library(lme4) library(jtools) library(interactions) #ML library(caret) #utilitaires library(rcompanion) #graphismes library(ggthemes) theme_set(theme_bw()) #palettes library(colorspace) #pour les couleurs Lensemble du code est disponible sur github. A ce stade cest encore très embryonnaire. Les proches pourrons cependant y voir lévolution du projet et de la progression Quelques conventions décriture du code r On appele les dataframes de manière générale df, les tableaux intermédiaires sont appelé systématiquement foo Gestion des palettes de couleurs ** une couleur :\" royalblue\" ** deux couleurs ** 3 à 7 couleurs On emploie autant que possible le dialecte tidy. Les chunks sont notés X, le chapitre, 01 à n, les jeux. 502 est le second chunk du chapitre 4. On commente au maximum les lignes de code pour épargner le corps du texte et le rendre lisible 2.3 A faire todo list : insérer un compteur google analytics ( voir https://stackoverflow.com/questions/41376989/how-to-include-google-analytics-in-an-rmarkdown-generated-github-page) modifier le titre en haut à gauche vérifier le système de références voir ( https://doc.isara.fr/tuto-zothero-5-bibtex-rmarkdown-zotero/) Vérifier la publication en pdf References "],["intro.html", "Chapitre 3 Introduction 3.1 Science ou technique ? 3.2 histoires des logiciels statistiques 3.3 Le processus de traitement des données 3.4 Les facteurs de développement des datasciences 3.5 du ML à lIA", " Chapitre 3 Introduction 3.1 Science ou technique ? Plûtôt que le terme consacré de Data sciences, il vaudrait mieux parler de data ingiénérie dans la mesure où le data scientiste participe à un processus de production qui va de lacquisition des donnée à leur propagation dans lorganisation ou la société. La technique domine sur la science et lunité se trouve dans lintégration de ce processus. La révolution des données vient de linteropérabilité croissante de ces techniques et dune intégration qui fluidifie le passage dune étape à une autre. Standards et langages en sont les éléments clés. Du côté des sciences, ce dont bénéficie lunivers des data sciences, cest lhéritage de cultures statistiques foissonante qui après sêtre développée dans leur cocon displinaires, se retrouvent désormais rassemblée dans un même langage. Bien sur il y a de manière sous-jascente à ces cultures les mathématiques et les statistiques mathématiques qui construisent les fondements des modèles et des techniques. Mais le développement sest fait souvent quand le scientifique se retrouve face à un problème où une observation. Prenons le cas des psychologues qui ont inventé lanalyse factorielle dans le but de pouvoir tester certains de leurs concepts : un degré dintelligence, une personnalité, des attitudes. Ou celui des écologues qui souhatent estimer une population de poisson dans une rivière, problème qui a donné naissance aux modèles de capture recapture. On pourrait ajouter les géographes avec les modèles danalyse spatiale, les financiers face à la variabilité des cours des places boursières, etc. Celui des économètres est peut-être le plus évident. Les biostatisticiens sont des contributeurs importants. Ce que la technique apporte cest lintégration par un langage et donc un ensemble de conventions, incarnées par r et python, dalgoritmes, et de programmes qui ne sont plus spécifique à un domaine, mais peuvent circuler de lun à lautre. Cest ainsi que le catalogues de toutes les techniques psychométriques devient accessible aux autres disciplines par le biais dun pachage en particulier , psych. De la même manière loutillage des linguiste devient accessible aux autres disciplines, pensons aux économiste qui intéègre dans le indicateurs des sources textuelle telle que lanalyse du sentiment. Linteropérabilité apportée par ces langages ne se définit pas que par lalgorithme qui aurait été porté dun autre langage vers celui-ci ( des cas de réécriture ?) mais aussi par des programme passerelle qui à partir de r permettent dactivité des algorithme écrit en C, en javascript ou tout autre langage plus informatiques et souvent plus éfficace. 3.2 histoires des logiciels statistiques Et cest ce quon observe dans lévolution des logiciels 1980 : statitcf 1980 : SAS comme accès à r 1990 : SPSS http://www.deenov.com/blog-deenov/histoire-du-logiciel-spad.aspx des système portable intégration graphique la modularisation : base /fonction/ packages 3.3 Le processus de traitement des données Acquisition Codification , filtrage et correction derreur Structuration des données : api, open data Exploration Modélisation : validation : tests versus AB testing Simulation et décision Vizualisation et sensemaking Déploiement : Contrôle : Publication : dash board, pdf , slide etc, webb site 3.4 Les facteurs de développement des datasciences Ces développements sont favorisés par un environnement fertile dont trois facteurs se renforcent mutuellement. 3.4.1 Une lingua franca histoire de r histoire de python 3.4.2 Une communauté Le second facteur , intimement lié au premier, est la constitution dune large communauté de développeurs et dutilisateurs qui se retrouvent aujourdhui dans des plateformes de dépots (Github, Gitlab), de plateformes de type quora (StalkOverFlow), de tutoriaux, de blogs (BloggeR), de journaux (Journal of Statistical Software) et de bookdown. Des ressources abondantes sont ainsi disponibles et facilitent la formation des chercheurs et des data scientists. Toutes les conditions sont réunies pour engendrer une effervescence créative. 3.4.3 La multiplication des sources de données. Le troisième est la multiplication des sources de données et leur facilité daccès. Les données privées, et en particulier celles des réseaux sociaux, même si un péage doit être payé pour accéder aux APIs, popularisent le traitement de données massives. Le mouvement des données ouvertes (open data) proposent et facilitent laccès à des milliers de corps de données : retards de la SNCF, grand débat, le formidable travail de lInsee, european survey etc. 3.5 du ML à lIA "],["prise-en-main.html", "Chapitre 4 Prise en main 4.1 La convention du Rmarkdown 4.2 Lire les données 4.3 Les accès directs 4.4 Dplyr pour manipuler les données 4.5 Pour aller plus loin 4.6 Etude de cas", " Chapitre 4 Prise en main Pour démarrer : 1 - Télécharger et installer r sur le site du Comprehensive r Archive Network 2 - Télécharger et installer Rstudio.(version free) 3 - Dans le cadre de cet atelier, on adopte la méthode du rMarkdown, On recommande fortement de lire louvrage de référence, même si la prise en main est très rapide. Il est désormais indispensable dutiliser le package tidyverse et en particulier les fonctions de manipulation et de pipe de fichier de dplyr 4.1 La convention du Rmarkdown Différentes manières dinteragir avec r sont possibles, dans ce manuel nous adoptions les méthodes rmarkdown. La première est le mode console, pour de petite opérations et un utilisateur chevronné, celà peut être commode car rapide mais très rapidement on sera amené à enregistrer les opérations dans des scripts. Mais pour produires des résultats, il faut lancer le script. Une idée novatrice a été dintégrer lensemble des élements dans un seul document : le script découpé en petits éléments : des chunks, le commentaire et lanalyse verbabe dans un format texte, et le résultat. Dans lunivers python il sagit des carnets Jupiter, pour r cest le rmarkdown. Cest un dialecte du markdown générique adapté au langage r. On recommande au lecteur den lire le manuel et de le garder dans ses onglets. Quelques éléments de base : un document markdown est composé de plusieurs éléments Yalm dans cet entête les éléments essentiels sont définis et paramétrés Texte : il suit les conventions de mise en forme du html : ** des # pour les niveau de titres ** (x)[*.html] pour des liens et pour des images ** Les chunks sont isolé par 3 tiks au début et à la fin. Résultats https://rmarkdown.rstudio.com/authoring_pandoc_markdown.html#Footnotes On peut en réalité constituer un document complet le le publier en word, en hatml ou mieux en pdf/latex. avec les éléments suivant bibliographie références liens images 4.2 Lire les données La première étape cest la lecture des données. On commence par le plus simple la lecture de fichiers locaux, on jette un coup doeil à la diversité des formats, on introduit à la technique des accès directs bien utile pour sassurer que les données sont bien fraiches. 4.2.1 le cas usuels des *.csv df &lt;- read_csv(&quot;./Data/BXL_listings.csv&quot;) 4.2.2 La diversité des formats Peu de formats échappent à r, ils peuvent faire appel à des packages spécifiques excell Json shape et autre GIS : les formats bibliographique : bib et ris 4.3 Les accès directs Interfaces le génie des API : ne pas se soucier de la mise à jour à chaque fois quon lance un calcul. exemples : base darchive de presse api des réseaux sociaux open data 4.4 Dplyr pour manipuler les données Cest un des packages essentiel de la suite tidyverse. 4.4.1 Des pipes %&gt;% Une grand part de lintérêt de dplyr est de reprendre un opérateur de maggritr très utiles : le pipe : %&gt;%. Celui ci permet de passer le résultats de lopération à gauche, dans la fonction de droite. Un exemple simple . Dans la ligne de code suivante, une première fonction lit le fichier CSV, et envoie le résultat de cette lecture dans une fonction graphique élémentaire: compter le nombre doccurences des modalité de la variable room_type. On reviendra longuement sur ggplot, à ce stade ce qui compte cest de retenir le procédé. On va très vite en donner des exemples plus variés. g &lt;- read_csv(&quot;./Data/BXL_listings.csv&quot;) %&gt;% ggplot(aes(x=price))+geom_histogram() g 4.4.2 Des verbes Loriginalité de dplyr est de définir des fonctions comme des verbes. Chaque verbe désigne un type daction. On va les examiner progressivement et dplyr qui va nous permettre de manipuler les données aisément. Ils sont simples à comprendre : tansformer une variables, filter les obsersation selon un critère, isoler des variables, les groupper pour en calculer des résultats statistiqyes ( somme, moyenne, variance, max min etc) * les déplouer selon un format long ou les distribuer en différents critères, les fusionner enfin selon les grandes modalité du SQL) 4.4.2.1 Mutate En Français cest transformer. On modifie la valeur dune variable par une fonction plus ou moins complexe, éventuellement en ajoutant des conditions. Dans notre exemple, faisant au plus simple, puisque la distribution est asymétrique, une transformation du prix par les log peut donner des résultats intéressants. Et cest le cas. On retrouve une distribution qui semble être gaussienne. g &lt;- read_csv(&quot;./Data/BXL_listings.csv&quot;) %&gt;% mutate(price=log10(price))%&gt;% ggplot(aes(x=price))+geom_histogram() g 4.4.2.2 Filter On peut voulir se concentrer sur une sous population. par exemple les chambres privées g &lt;- read_csv(&quot;./Data/BXL_listings.csv&quot;) %&gt;% filter(room_type==&quot;Private room&quot;)%&gt;% # on note que le signe == est double, c&#39;est pour dire que la variable prend la valeur, ou non, qui est proposée mutate(price=log10(price))%&gt;% ggplot(aes(x=price))+geom_histogram() g * filter 4.4.2.3 select g &lt;- read_csv(&quot;./Data/BXL_listings.csv&quot;) %&gt;% filter(room_type==&quot;Private room&quot;)%&gt;% # on note que le signe == est double, c&#39;est pour dire que la variable prend la valeur, ou non, qui est proposée mutate(price=log10(price))%&gt;% ggplot(aes(x=price))+geom_histogram() g 4.4.2.4 Group_by et summarize cest une opération clé, en groupant selon les modalités dune ou pluseirs variables, on peut construire des tableaux aggrégés.On lassociera à summarize qui permet de calculer les statistique aggrégé selon le groupe que lon a définit g &lt;- read_csv(&quot;./Data/BXL_listings.csv&quot;)%&gt;% dplyr::select(neighbourhood, price)%&gt;% group_by(neighbourhood ) %&gt;% summarise(price=mean(price))%&gt;% # ce qi permet de calculer le prix moyen par quartier ggplot(aes(x=neighbourhood, y=price))+ geom_bar(stat= &quot;identity&quot;)+ coord_flip() +labs(title=&quot;Prix moyen des Airbnb à Bruxelles&quot;) g 4.4.2.5 gather and spread Si pour lhabitué des feuilles excell les données croisent des observations avec des variables, ce format nest pas le seul moyuen de répsenter des données, et pas forcément le meilleurs 4.4.2.6 merge On sera souvent amené à fabriquer des tableaux de donnée en les enrichissant dun autre. On sera amené fusionner les données. Le cas le plus simples est dajouter dautres observation à un fichier de données, si les variables sont identitiques on peut concaténer diffrents jeux de données avec la fonction de base rbind au contraire si les observation sont les mêmes, et que seules les variables sont différentes on peut utiliser cbind. Léquivalent de DPLYR est row_bind et column_bind mais très souvent on sera dans des cas différents et la fusion des données devra suivre des index merge quatre types de fusion genérale fusion à gauche fusion à droite https://coletl.github.io/tidy_intro/lessons/dplyr_join/dplyr_join.html 4.5 Pour aller plus loin On engage le lecteur à poursuivre avec le bookdown au-delà du markdown une théorie des tidy data 4.6 Etude de cas Le plan de recodage dun jeu de données quon va employer dans les chapitre suivant. Il sappuie sur le langage de base. Un excercice peut être de le réécrire avec dplyr. df&lt;-readRDS(&quot;./data/trustFrAll.rds&quot;) #quelques recodages #on renomme pour plus de clarte names(df)[names(df)==&quot;trstun&quot;] &lt;- &quot;NationsUnies&quot; names(df)[names(df)==&quot;trstep&quot;] &lt;- &quot;ParlementEurop&quot; names(df)[names(df)==&quot;trstlgl&quot;] &lt;- &quot;Justice&quot; names(df)[names(df)==&quot;trstplc&quot;] &lt;- &quot;Police&quot; names(df)[names(df)==&quot;trstplt&quot;] &lt;- &quot;Politiques&quot; names(df)[names(df)==&quot;trstprl&quot;] &lt;-&quot;Parlement&quot; names(df)[names(df)==&quot;trstprt&quot;] &lt;- &quot;Partis&quot; names(df)[names(df)==&quot;pplhlp&quot;] &lt;- &quot;help&quot; names(df)[names(df)==&quot;pplfair&quot;] &lt;- &quot;fair&quot; names(df)[names(df)==&quot;ppltrst&quot;] &lt;- &quot;trust&quot; #on construit les scores de confiance df&lt;-df %&gt;% mutate(trust_institut=(Partis+Parlement+Politiques+Police+Justice+NationsUnies+ParlementEurop)*10/7,trust_interpersonnel=(help+fair+trust)*10/3) df$Year&lt;-2000 #recodage des variables independantes df$Year[df$essround==1]&lt;-2002 df$Year[df$essround==2]&lt;-2004 df$Year[df$essround==3]&lt;-2006 df$Year[df$essround==4]&lt;-2008 df$Year[df$essround==5]&lt;-2010 df$Year[df$essround==6]&lt;-2012 df$Year[df$essround==7]&lt;-2014 df$Year[df$essround==8]&lt;-2016 df$Year[df$essround==9]&lt;-2018 df$Year&lt;-as.factor(df$Year) df$OP&lt;-&quot; &quot; #ggplot(df,aes(x=lrscale))+geom_histogram() df$OP[df$lrscale==0] &lt;- &quot;Extrême gauche&quot; df$OP[df$lrscale==1] &lt;- &quot;Gauche&quot; df$OP[df$lrscale==2] &lt;- &quot;Gauche&quot; df$OP[df$lrscale==3] &lt;- &quot;Centre Gauche&quot; df$OP[df$lrscale==4] &lt;- &quot;Centre Gauche&quot; df$OP[df$lrscale==5] &lt;- &quot;Ni G ni D&quot; df$OP[df$lrscale==6] &lt;- &quot;Centre Droit&quot; df$OP[df$lrscale==7] &lt;- &quot;Centre Droit&quot; df$OP[df$lrscale==8] &lt;- &quot;Droite&quot; df$OP[df$lrscale==9] &lt;- &quot;Droite&quot; df$OP[df$lrscale==10] &lt;- &quot;Extrême droite&quot; #la ligne suivante est pour ordonner les modalités de la variables df$OP&lt;-factor(df$OP,levels=c(&quot;Extrême droite&quot;,&quot;Droite&quot;,&quot;Centre Droit&quot;,&quot;Ni G ni D&quot;,&quot;Centre Gauche&quot;,&quot;Gauche&quot;,&quot;Extrême gauche&quot;)) df$revenu&lt;-&quot; &quot; df$revenu[df$hincfel&gt;4] &lt;- NA df$revenu[df$hincfel==1] &lt;- &quot;Vie confortable&quot; df$revenu[df$hincfel==2] &lt;- &quot;Se débrouille avec son revenu&quot; df$revenu[df$hincfel==3] &lt;- &quot;Revenu insuffisant&quot; df$revenu[df$hincfel==4] &lt;- &quot;Revenu très insuffisant&quot; df$revenu&lt;-factor(df$revenu,levels=c(&quot;Vie confortable&quot;,&quot;Se débrouille avec son revenu&quot;,&quot;Revenu insuffisant&quot;,&quot;Revenu très insuffisant&quot;)) df$habitat&lt;-&quot; &quot; df$habitat[df$domicil==1]&lt;- &quot;Big city&quot; df$habitat[df$domicil==2]&lt;-&quot;Suburbs&quot; df$habitat[df$domicil==3]&lt;-&quot;Town&quot; df$habitat[df$domicil==4]&lt;-&quot;Village&quot; df$habitat[df$domicil==5]&lt;-&quot;Countryside&quot; df$habitat&lt;-factor(df$habitat,levels=c(&quot;Big city&quot;,&quot;Suburbs&quot;,&quot;Town&quot;,&quot;Village&quot;,&quot;Countryside&quot;)) df$genre&lt;-&quot; &quot; df$genre[df$gndr==1]&lt;-&quot;H&quot; df$genre[df$gndr==2]&lt;-&quot;F&quot; df$age&lt;-&quot; &quot; df$age[df$agea&lt;26]&lt;-&quot;25&lt;&quot; df$age[df$agea&gt;25 &amp; df$agea&lt;36]&lt;-&quot;26-35&quot; df$age[df$agea&gt;35 &amp; df$agea&lt;46]&lt;-&quot;36-45&quot; df$age[df$agea&gt;45 &amp; df$agea&lt;66]&lt;-&quot;46-65&quot; df$age[df$agea&gt;65 &amp; df$agea&lt;76]&lt;-&quot;66-75&quot; df$age[df$agea&gt;75]&lt;-&quot;75&gt;&quot; df$age&lt;-factor(df$age,levels=c(&quot;25&lt;&quot;,&quot;26-35&quot;,&quot;36-45&quot;,&quot;46-65&quot;,&quot;66-75&quot;, &quot;75&gt;&quot;)) saveRDS(df, &quot;./data/dfTrust.rds)&quot;) "],["une-introduction-à-ggplot.html", "Chapitre 5 Une introduction à ggplot 5.1 La grammaire des graphiques 5.2 Une étude de cas 5.3 Analyse univariée 5.4 Analyse bivariée", " Chapitre 5 Une introduction à ggplot Nous avons appris à lire des données, à les manipuler, nous avons le droit dêtre pressé de les représenter de manière immédiatement lisible, par des dataviz. On présente dabord rapidement le concept de grammaire des graphiques On se cncentre ensuite sur un cas détude On décline. 5.1 La grammaire des graphiques Cest sans doute une des percées conceptuelles laplus intéressante des datasciences. La représentation graphhiques des données fait lobjet à la fois dune explosion créative mais aussi dune synthèse théorique. Cest lapport de la grammaire des graphiques. Ces outils sappuient sur lidée de grammaire des graphiques. En voici un clair résumé.En français il y a toujours le larmarange 5.1.1 Un modèle en couche Celle-ci met un ordre dans les éléments qui composent un graphique et les superpose. layers laesthetic definit les éléments que lon veut représenter : ce quon met en abscisse, ce quon met en ordonnné, les groupes que lon veut distinguer. la geométrie (geom_x)qui définit la forme de représentation les échelles (scale_x) Labelisation (labs) les templates ggplot est construit selon cette structure. Voici le book de référence , qui est au centre de ce cours. On aura besoin de manière assez systématique de manipuler les données avant de les représenter, dplyr nous permet de le faire aisément. 5.1.2 Une typologie des représentations Un point de départ fondamental est la gallery de ggplot,, elle présente de manière synthétique toute les types de figures qui peuvent être présentées. Avec du code facilement reproductible. Une classification simple Analyse univariée Analyse bi variée Analyse multivariée ** les variables sont quantitatives : on analyse des matrices de corrélations ** les variables sont qualitatives : on analyse des tableaux croisés Analyse geospatiale Analyse de réseaux analyse darbres Diagramme de flux 5.1.3 Lesthétique Lésthétique du diagramme dépends de ses lay out et de ses couleurs 5.1.3.1 Quelques templates 5.1.3.2 lart des palettes Lart des couleurs tient dans les palettes on aimera celles de Wes Anderson, on peut adorer fishualize. on trouvera 5.2 Une étude de cas Les données sont extraites de lESS, une sélection est disponible ici. Elle couvre les 9 vagues et concernent la France et LAllemagne. Les variables dépendantes (celles que lon veut étudier et expliquer) sont les 9 items de la confiance, les variable considérées comme indépendantes (ou explicatives) sont une sélection de variables socio-démographiques : âge, genre, perception du pouvoir dachat, orientation politique, type dhabitat. On fait quelques opérations de recodage et on renomme les variables avoir une lecture plus aisée des variables et de leurs catégories. On appele au début les bibliothèques. ggplot - dont voici le book de référence, qui est au centre de ce cours, 5.3 Analyse univariée Lanalyse univarié, comme son nom lindique, ne sintéresse quà une seule variable. Celle-ci peut être quantitative ou qualitative etne comporter quun nombre limité de modalités entre lesquels aucune comparaison de grandeur ne peut être faite. Les premières ont le plus souvent dans r un format numeric, les autres correspondent au format factor. 5.3.1 Le cas des variables quantitatives Les variables quantitatives décrivent une variable dont les valeurs décrivent les quantités dune grandeur. Elle peuvent être discrètes (dénombrement du dun nombre dunités) - le nombre dhabitant), ou continue (le nombre de km parcourus). lhistogramme est loutil de base pour représenter la distribution dune telle variable. Il représente pour des intervalles de valeurs donnés, la fréquence des observations. Sa syntaxe simple comporte dabord la définition de la variable et de la source de données, puis une des géométrie de ggplot : la fonction geom_histogram. Dans notre exemple, on va représenter le score de confiance institutionnelle pour la France en se concentrant sur la dernière vague denquête. #On charge le fichier recodé à la fin du chapitre précédent df&lt;-readRDS(&quot;./data/dfTrust.rds)&quot;) #filtrage sur 2018 et la France. foo&lt;-df%&gt;%filter(Year==&quot;2018&quot; &amp; cntry==&quot;FR&quot; &amp; !is.na(trust_institut)) # on stocke le diagramme dans l&#39;objet g00, pour le réutiliser ultérieurement et pouvoir le compléter. g00&lt;-ggplot(foo,aes(x=trust_institut))+ geom_histogram() g00 On va améliorer laspect en modifiant la couleur et la largeur des barres, ajoutant un thème, en précisant les éléments textuels (titres, label) en calculcant et en représentant la valeur moyenne. #on calcule la moyenne moy=mean(foo$trust_institut, na.rm=TRUE) #avec tous les éléments g01 &lt;-ggplot(foo,aes(x=trust_institut))+ geom_histogram(binwidth=5,fill=&quot;pink&quot;)+ labs(title= &quot;Distribution de la confiance institutionnelle&quot;, subtitle= paste0(&quot;moyenne = &quot;,round(moy,2)), caption=&quot;ESS2002-2018&quot;, y= &quot;frequence&quot;, x=&quot;confiance (index de 0 à 100)&quot;) + geom_vline(xintercept=moy, color=&quot;red&quot;,size=1.5) g01 diagramme de densité : Au lieu de représenter les effectifs, on ramène leffectif total à 1. g04&lt;-ggplot(foo,aes(x=trust_institut))+ geom_density(fill=&quot;pink2&quot;) + labs(title= &quot;Fonction de densité de probabilité&quot;, caption=&quot;ESS2002-2018&quot;,y= &quot;frequence&quot;,x=&quot;Confiance (index de 1 à 100)&quot;) g04 enfin on peut examiner par rapport à une distribution théorique, en loccurrence une distribution gaussienne, ou normale, de paramètres égaux à la moyenne et la variance empirique de la distribution. Lajustement est convenable même si on observe une déviation sur la droite. Cest pourquoi on calcule aussi la Kurtosis et le skewness de la distribution. #On a déjà calculé la moyenne : mean #il nous manque l&#39;écart-type et sd&lt;-sd(foo$trust_institut, na.rm=TRUE) library(moments) sk&lt;-skewness(foo$trust_institut) ks&lt;-kurtosis(foo$trust_institut) g05&lt;-ggplot(foo,aes(x=trust_institut))+ labs(title= &quot;Distribution de la confiance institutionnelle&quot;, caption=&quot;ESS2002-2018&quot;,y= &quot;frequence&quot;,x=&quot;confiance (index de 0 à 100)&quot;) + geom_density(fill=&quot;pink2&quot;)+ stat_function(fun = dnorm,color=&quot;red&quot;,size=1.2, args = list(mean =moy, sd=sd)) g05 Un grand classique du test de normalité dune distribution est le diagramme QQ g06 &lt;- ggplot(foo, aes(sample = trust_institut)) + stat_qq() + stat_qq_line()+ labs(title= &quot;QQplot confiance interpersonnelle&quot;, caption=&quot;ESS2002-2018&quot;,y= &quot;Echantillon&quot;,x=&quot;Théorique&quot;) g06 On fini cette étude détaillée par lajustement dabord dun modèle (loi normale) aux données. Ensuite dun modèle de mélange ( Mixture model) par lequel on défiit la loi de distribution sous jascente, comme un mélange entre deux populations normale de paramètres distincts. https://tinyheero.github.io/2015/10/13/mixture-model.html df0&lt;-df %&gt;% na.omit() library(MASS) fit&lt;-fitdistr(df0$trust_interpersonnel,&quot;normal&quot;) fit ## mean sd ## 52.48548790 16.57617220 ## ( 0.09344363) ( 0.06607462) g07&lt;- g05+stat_function(fun = dnorm ,color=&quot;orange&quot;,size=1.2, args = list( mean=52.48, sd=16.57)) g07 library(mixtools) trust = foo$trust_institut mixmdl = normalmixEM(trust, k=2) ## number of iterations= 513 mixmdl$mu ## [1] 39.23073 56.04167 mixmdl$sigma ## [1] 17.90246 10.56092 mixmdl$lambda ## [1] 0.6719506 0.3280494 plot(mixmdl,which=2) lines(density(trust), lty=2, lwd=2) Finalement si notre distribution est univariée, car nétudiant quune variable, on peut quand distinguer deux population distinctes. 5.3.1.1 Dautres méthodes boxplot violin plot barcode 5.3.2 Quand la variable est qualitative Quand la variable est qualitative, que ses variables sont discrètes, la manière de représenter la plus commune est le fameux camembert que les experts écartent. Un diagramme en barre représente mieux les proportions. Un premier exemple pour représenter les vagues denquêtes g08&lt;-ggplot(df,aes(x=age))+ geom_bar(fill=&quot;skyblue&quot;)+ labs(title= &quot;Evolution de la confiance interpersonnelle&quot;, caption=&quot;ESS2002-2018&quot;,y= &quot;frequence&quot;,x=&quot;Vague d&#39;enquête&quot;) g08 en % et en 2 jeux de couleurs standard et couleur foo&lt;-df %&gt;%filter(!is.na(age)) g10&lt;-ggplot(foo,aes(x=age, y = prop.table(stat(count)),label = scales::percent(prop.table(stat(count)))))+ geom_bar(aes(fill = age)) + coord_flip()+ labs(title= &quot;Répartition de la population par classe d&#39;âge&quot;, caption=&quot;ESS2002-2018&quot;,y= &quot;%&quot;,x=&quot;classes d&#39;age&quot;) + scale_y_continuous(labels = scales::percent)+ geom_text(stat = &#39;count&#39;,position = position_dodge(.9), hjust = 1, size = 3) g10 si on tient au diagramme en cercle, autant opter pour un treemap avec la bibliothèque treemapifi foo&lt;-df %&gt;%filter(!is.na(age)) g10&lt;-ggplot(foo,aes(x=&quot;&quot;, y = prop.table(stat(count)),label = scales::percent(prop.table(stat(count)))))+ geom_bar(aes(fill = age)) + labs(title= &quot;Répartition de la population par classe d&#39;âge&quot;, caption=&quot;ESS2002-2018&quot;,y= &quot;%&quot;,x=&quot;classes d&#39;age&quot;) + geom_text(stat = &#39;count&#39;,position = position_dodge(.9), hjust = 1, size = 3) + coord_polar(&quot;y&quot;, start=0) g10 https://cran.r-project.org/web/packages/treemapify/vignettes/introduction-to-treemapify.html si on tient au diagramme en cercle, autant opter pour un treemap avec la bibliothèque treemapifi library(treemapify) tree1&lt;-df %&gt;% mutate(n=1)%&gt;%group_by(age) %&gt;% summarize(n=sum(n)) %&gt;% filter(!is.na(age)) g11 &lt;- ggplot(tree1, aes(area = n, fill=n),label=age) + geom_treemap() + geom_treemap_text(aes(label=age),colour = &quot;white&quot;, place = &quot;centre&quot;,grow = TRUE)+ labs(title= &quot;Répartition de la population par classe d&#39;âge&quot;, caption=&quot;ESS2002-2018&quot;,y= NULL,x=NULL) g11 5.4 Analyse bivariée Comme son nom lindique, il sagit dexaminer la relation entre deux variables et détudier leur distribution conjointe. deux variables quantitatives deux variable qualitatives une variable quanti et une variable quali. 5.4.1 Diagrammes xy - la magie des corrélations par comparer des distribution de plusieurs groupes (variables catégorielles) par comparer des moyennes dune variable dépendante en fonction de plusieurs variables indépendantes catégorielle mesurer lassociation entre deux variables qualitatives venons en à analyser les relation entre deux variables quantitatives. foo&lt;-df %&gt;%filter(cntry==&quot;FR&quot; &amp; Year==&quot;2018&quot;) g31&lt;- ggplot(foo, aes(x= trust_interpersonnel,y=trust_institut)) + geom_point( size=0.1) g31 Ce graphe est peu clair, il y a trop de points qui prennent des valeurs discrètes. Une astuce est de donner une position aléatoire pour sur disperser, on fait mieux apparaitre la densité de points. On ajoute la représentation de deux courbe dajustement, lune linéraire et lautre non linéaires. Mais en attendant en voici un calcul élémentaire. le calcul de la variance \\[{SS}_{xx} = \\sum (x - \\bar{x})^2 = \\sum x^2 - \\frac {(\\sum x)^2}{n}\\] le calcul de la covariance \\[{SS}_{xy} = \\sum (x - \\bar{x})(y - \\bar{y}) = \\sum xy - \\frac {(\\sum x)(\\sum y)}{n}\\] et la corrélation qui est le rapport de la covariance sur la racine carrée du produit des variances de x et y. \\[r = \\frac {{SS}_{xy}}{\\sqrt {{SS}_{xx}{SS}_{yy}}}\\] la corrélation est de lordre dun peu plus 0,42 ce qui est assez élevé mais laisse une certaine indépendance des variables. Elle désignent des objets liés mais différents. #psych r&lt;-cor.test(foo$trust_interpersonnel, foo$trust_institut) rp&lt;-round(r$estimate,3) rp ## cor ## 0.404 Amélirons de grapf library(ggExtra) g32&lt;-ggplot(foo, aes(x= trust_interpersonnel,y=trust_institut)) + geom_point(position = &quot;jitter&quot;, size=0.1, color=&quot;grey&quot;)+ geom_smooth(method=&quot;lm&quot;, se=TRUE) + geom_smooth(method=&quot;gam&quot;,color=&quot;red&quot;) + labs(title = &quot;Relation entre confiance \\ninstitutionnelle et interpersonnelle&quot;, subtitle = paste(&quot;r de pearson: &quot;,rp ), x= &quot;Confiance interpersonnelle&quot;, y=&quot; Confiance institutionnelle&quot;) ggMarginal(g32 ,type = &quot;density&quot;, fill = &quot;Royalblue1&quot;, alpha=.5) on peut souhaiter ajouter une droite des moindre carrés (calculée pour chaque vague denquête pour évaluer la stabilité de la relation dans le temps). Les lignes sont parallèles, la corrélation ne change pas dans le temps, cest une relation stable. Les deux formes de confiance vont dans le meme sens. On verra dans un autre chapitre comment calculer ces droites de corrélations. Une autre représentation plus éclatée qui ne montre rien de plus que la régularité Une autre façon de représenter est celle de carte de densité de probabilité. g32&lt;-ggplot(foo, aes(x= trust_interpersonnel,y=trust_institut)) + geom_point(position = &quot;jitter&quot;, size=0.1, color=&quot;grey&quot;)+geom_density2d()+ labs(title = &quot;Relation entre confiance institutionnelle et interpersonnelles&quot;, subtitle = paste(&quot;r de pearson: &quot;,rp )) g33&lt;-ggplot(foo, aes(x= trust_interpersonnel,y=trust_institut)) + geom_density2d_filled(aes(fill = ..level.., color = ..level..), contour_var = &quot;density&quot;)+ labs(title = &quot;Relation entre confiance institutionnelle et interpersonnelles&quot;, subtitle = paste(&quot;r de pearson: &quot;,rp ))+theme(legend.position = &quot;none&quot;) plot_grid(g32, g33, labels = c(&#39;A&#39;, &#39;B&#39;), label_size = 12) 5.4.2 Comparer les distributions Dans notre base on a melangé les données de lAllemagne et de la France. On va comparer leur distribution. Et tant quà faire, puisque quon a deux variables, on va faire deux comparaions. A cette fin, nous construisons un tableau de donnée spécifique. #on recode en facteur la variable foo &lt;- df %&gt;% dplyr::select(cntry,trust_institut, Year,trust_interpersonnel) %&gt;% filter( Year==&quot;2018&quot;) %&gt;% dplyr::select(-Year)%&gt;% drop_na() %&gt;% gather(variable, value, -cntry) #on peut utiliser &quot;facet&quot; g20&lt;-ggplot(foo,aes(x=value))+ geom_density(binwidth=10, fill=&quot;pink&quot;)+ facet_grid(cntry~variable)+ labs(title= &quot;Confiance institutionnnelle&quot;, caption=&quot;ESS2002-2018&quot;,y= &quot;frequence&quot;,x=&quot;Confiance&quot;) g20 g21&lt;-ggplot(foo,aes(x=variable, y=value))+ geom_violin( fill=&quot;pink&quot;) + geom_boxplot(width=0.1)+ facet_grid(cntry~.)+ labs(title= &quot;Confiance institutionnnelle&quot;, caption=&quot;ESS2002-2018&quot;,y= &quot;frequence&quot;,x=&quot;Confiance&quot;) g21 5.4.3 Comparaison de moyennes ggplot traite les données quon lui donne. Avec les historgram on accède directement aux données. Si on souhaite représenter les moyennes et les comparer il faut une étape supplémentaire qui vise à calculer ce tableau de données : les valeurs de chacune des vague denquête. df_wave&lt;-df %&gt;% filter(cntry==&quot;FR&quot; &amp; Year==&quot;2018&quot;) %&gt;% group_by(revenu) %&gt;% summarise(trust_interpersonnel=mean(trust_interpersonnel, na.rm=TRUE), trust_institut =mean(trust_institut, na.rm=TRUE)) %&gt;% filter(!is.na(revenu)) %&gt;% gather(variable, value, -revenu) df_wave ## # A tibble: 8 x 3 ## revenu variable value ## &lt;fct&gt; &lt;chr&gt; &lt;dbl&gt; ## 1 Vie confortable trust_interpersonnel 55.6 ## 2 Se débrouille avec son revenu trust_interpersonnel 51.7 ## 3 Revenu insuffisant trust_interpersonnel 46.7 ## 4 Revenu très insuffisant trust_interpersonnel 41.4 ## 5 Vie confortable trust_institut 50.2 ## 6 Se débrouille avec son revenu trust_institut 44.1 ## 7 Revenu insuffisant trust_institut 39.1 ## 8 Revenu très insuffisant trust_institut 34.5 g06a&lt;-ggplot(df_wave,aes(x=revenu,y=value, group=variable))+ geom_bar(stat=&quot;identity&quot;,aes(fill=variable), position =position_dodge())+ labs(title= &quot;Confiance institutionnnelle&quot;, caption=&quot;ESS2002-2018&quot;,y= &quot;frequence&quot;,x=&quot;Confiance&quot;) g06a On a une solution mais pas la meilleure, on perd lidée de variance et ce serait bien dajouter des barres dintervalle de confiances , un diagramme en lignes serait plus élégant. On en profite pour corriger laspect des labels peu lisibles en les inclinants, et à choisir une échelle qui omettent les valeur supérieur à 70 et inférieure à 30 pour donner une vision plus respectueuses de la totalité de léchelle qui va de 0 à 100. Au passage on emploie à nouveau cowplot pour combiner les graphes, et ici plus précisément partager la légende des deux graphiques. On observera que si le niveau de confiance diminue avec le revenu, la confiance interpersonnelle est plus forte, et de manière parallèle, à la confiance institutionnelle. On remarquera enfin que cest pour les revenu les plus faibles que lestimation est la plus imprécise ou la variance la plus grande. df_wave2&lt;-df %&gt;% filter(cntry==&quot;FR&quot; &amp; Year==&quot;2018&quot;)%&gt;% group_by(revenu) %&gt;% mutate(n=1) %&gt;% summarise(trust_interpersonnel_se=sd(trust_interpersonnel, na.rm=TRUE), #on calcule l&#39;écartype des deux variables trust_institut_se =sd(trust_institut, na.rm=TRUE), n=sum(n), trust_interpersonnel_se= 2*trust_interpersonnel_se/sqrt(n), # on calcule l&#39;erreur type d&#39;échantillonnage trust_institut_se=2*trust_institut_se/sqrt(n) ) %&gt;% dplyr::select(-n) %&gt;% filter(!is.na(revenu)) %&gt;% gather(variable, value, -revenu) %&gt;% #on passe en format long dplyr::select(-revenu,-variable)%&gt;% rename(se=value) df_wave3&lt;-cbind(df_wave,df_wave2) #on concatène les moyennes et les erreurs types #on peut enfin produire le graphique g06a&lt;-ggplot(df_wave3,aes(x=revenu,y=value, group=variable))+ geom_line(stat=&quot;identity&quot;,aes(color=variable), size=1.5)+ geom_errorbar(aes(ymin=value-se, ymax=value+se, color=variable), width=.2,position=position_dodge(0))+ labs(title= &quot;Confiance et revenu&quot;,y= &quot;Moyenne&quot;,x=NULL)+ theme(axis.text.x = element_text( angle=45, hjust =1)) #on controle l&#39;angle et la position horizontale du label g06b&lt;-ggplot(df_wave3,aes(x=revenu,y=value, group=variable))+ geom_line(stat=&quot;identity&quot;,aes(color=variable), size=1.5)+ geom_errorbar(aes(ymin=value-se, ymax=value+se, color=variable), width=.2,position=position_dodge(0))+ ylim(0,100)+ labs(title= &quot;&quot;,y= &quot;Moyenne&quot;,x=NULL)+ theme(axis.text.x = element_text( angle=45, hjust =1)) #on controle l&#39;angle et la position horizontale du label prow &lt;- plot_grid( g06a + theme(legend.position=&quot;none&quot;), g06b + theme(legend.position=&quot;none&quot;), align = &#39;vh&#39;, labels = c(&quot;A&quot;, &quot;B&quot;, &quot;C&quot;), hjust = -1, nrow = 1 ) # extract a legend that is laid out horizontally legend_b &lt;- get_legend( g06a + guides(color = guide_legend(nrow = 1)) + theme(legend.position = &quot;bottom&quot;) ) # add the legend underneath the row we made earlier. Give it 10% # of the height of one plot (via rel_heights). plot_grid(prow, legend_b, ncol = 1, rel_heights = c(1, .1)) La visualisation est utile, encore faut-il quon soit bien certain que les variations ne soit pas le produit du hasard, de fluctuations déchantillonnage. Si en moyenne la perception du pouvoir dachat est associée à des moyennes de confiance décroissantes, les différences observées sont-elle significatives? Dans les représentations précédentes cest le choix de léchelle qui oriente lanalyse. On a un besoin dun test plus objectif.Celui est le classique test danalyse de variance (ANOVA). Celui-çi est le test danalyse de variance qui consiste à comparer la variance à lintérieur des groupes ( intra), et la variance entre les moyennes des groupes ( inter ou between). foo&lt;-df %&gt;% filter(cntry==&quot;FR&quot; &amp; Year==&quot;2018&quot;) %&gt;% drop_na() fit&lt;-lm(trust_institut~revenu, foo) anova(fit) ## Analysis of Variance Table ## ## Response: trust_institut ## Df Sum Sq Mean Sq F value Pr(&gt;F) ## revenu 3 27651 9217.1 32.052 &lt; 2.2e-16 *** ## Residuals 1686 484846 287.6 ## --- ## Signif. codes: 0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1 library(xtable) ft &lt;- xtable_to_flextable(xtable(anova(fit)), hline.after = c(0,2)) ft .tabwid table{ border-collapse:collapse; line-height:1; margin-left:auto; margin-right:auto; border-width: 0; display: table; margin-top: 1.275em; margin-bottom: 1.275em; border-spacing: 0; border-color: transparent; } .tabwid_left table{ margin-left:0; } .tabwid_right table{ margin-right:0; } .tabwid td { padding: 0; } .tabwid a { text-decoration: none; } .tabwid thead { background-color: transparent; } .tabwid tfoot { background-color: transparent; } .tabwid table tr { background-color: transparent; } .cl-247ce7a8{border-collapse:collapse;}.cl-247219a4{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-247219a5{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-24724082{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-24724083{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-24728e7a{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e7b{width:52.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e7c{width:58.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e7d{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e7e{width:65.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e7f{width:69.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e80{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e81{width:58.4pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e82{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e83{width:52.6pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e84{width:65.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b56c{width:69.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b56d{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b56e{width:52.6pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b56f{width:65.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b570{width:58.4pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b571{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b572{width:69.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;} DfSum SqMean SqF valuePr(&gt;F)revenu327,651.49,217.132.10.0Residuals1,686484,845.7287.6 #library(jtools) #summ(fit) #effect_plot(fit, pred=&quot;revenu&quot;) 5.4.4 Deux variables qualitatives Létude de la relation éventuelle entre deux variables qualitative sapprécie traditionnellement par une méthode de tableau croisé. 5.4.4.1 Tableau croisé Pour calculer le tableau croisé on utilise la fonction très simple table. t&lt;-table(foo$revenu,foo$habitat) t ## ## Big city Suburbs Town Village Countryside ## Vie confortable 118 82 161 142 31 ## Se débrouille avec son revenu 120 109 275 227 58 ## Revenu insuffisant 48 38 129 88 22 ## Revenu très insuffisant 9 5 18 10 0 prop.table(t,2) ## ## Big city Suburbs Town Village ## Vie confortable 0.40000000 0.35042735 0.27615780 0.30406852 ## Se débrouille avec son revenu 0.40677966 0.46581197 0.47169811 0.48608137 ## Revenu insuffisant 0.16271186 0.16239316 0.22126930 0.18843683 ## Revenu très insuffisant 0.03050847 0.02136752 0.03087479 0.02141328 ## ## Countryside ## Vie confortable 0.27927928 ## Se débrouille avec son revenu 0.52252252 ## Revenu insuffisant 0.19819820 ## Revenu très insuffisant 0.00000000 Mais ce nest pas esthétique, de flextable : proc_freq. Elle nous donne en peu de mots les effectif par cellule, les pourcentages en lignes, et en colonnes. ft1&lt;- proc_freq(foo, &quot;revenu&quot;, &quot;habitat&quot;, include.table_percent = FALSE, include.row_percent = FALSE, include.column_percent = TRUE) ft1 .tabwid table{ border-collapse:collapse; line-height:1; margin-left:auto; margin-right:auto; border-width: 0; display: table; margin-top: 1.275em; margin-bottom: 1.275em; border-spacing: 0; border-color: transparent; } .tabwid_left table{ margin-left:0; } .tabwid_right table{ margin-right:0; } .tabwid td { padding: 0; } .tabwid a { text-decoration: none; } .tabwid thead { background-color: transparent; } .tabwid tfoot { background-color: transparent; } .tabwid table tr { background-color: transparent; } .cl-24cf160e{border-collapse:collapse;}.cl-24c3371c{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-24c3371d{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-24c35e0e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-24c35e0f{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-24c3d2f8{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2f9{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2fa{width:168.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2fb{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2fc{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2fd{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2fe{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2ff{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d300{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d301{width:168.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d302{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e0{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e1{width:168.5pt;background-color:transparent;vertical-align: top;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e2{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e3{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e4{width:168.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e5{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e6{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e7{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e8{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e9{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9ea{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c420dc{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c420dd{width:168.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c420de{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;} habitatrevenulabelBig citySuburbsTownVillageCountrysideTotalVie confortableFrequency1188216114231534Col Pct40%35.04%27.62%30.41%27.93%Se débrouille avec son revenuFrequency12010927522758789Col Pct40.68%46.58%47.17%48.61%52.25%Revenu insuffisantFrequency48381298822325Col Pct16.27%16.24%22.13%18.84%19.82%Revenu très insuffisantFrequency951810042Col Pct3.05%2.14%3.09%2.14%0%TotalFrequency2952345834671111690 ft2&lt;- proc_freq(foo, &quot;revenu&quot;, &quot;habitat&quot;, include.table_percent = FALSE, include.row_percent = TRUE, include.column_percent = FALSE) ft2 .tabwid table{ border-collapse:collapse; line-height:1; margin-left:auto; margin-right:auto; border-width: 0; display: table; margin-top: 1.275em; margin-bottom: 1.275em; border-spacing: 0; border-color: transparent; } .tabwid_left table{ margin-left:0; } .tabwid_right table{ margin-right:0; } .tabwid td { padding: 0; } .tabwid a { text-decoration: none; } .tabwid thead { background-color: transparent; } .tabwid tfoot { background-color: transparent; } .tabwid table tr { background-color: transparent; } .cl-250accbc{border-collapse:collapse;}.cl-24fa0f4e{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-24fa0f4f{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-24fa3640{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-24fa3641{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-24fa842e{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa842f{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8430{width:168.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8431{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8432{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8433{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8434{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8435{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8436{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8437{width:168.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8438{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab20{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab21{width:168.5pt;background-color:transparent;vertical-align: top;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab22{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab23{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab24{width:168.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab25{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab26{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab27{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab28{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab29{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab2a{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fad212{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fad213{width:168.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fad214{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;} habitatrevenulabelBig citySuburbsTownVillageCountrysideTotalVie confortableFrequency1188216114231534Row Pct22.1%15.36%30.15%26.59%5.81%Se débrouille avec son revenuFrequency12010927522758789Row Pct15.21%13.81%34.85%28.77%7.35%Revenu insuffisantFrequency48381298822325Row Pct14.77%11.69%39.69%27.08%6.77%Revenu très insuffisantFrequency951810042Row Pct21.43%11.9%42.86%23.81%0%TotalFrequency2952345834671111690 5.4.4.2 le valeureux chi² Le test du chi2 sappuie sur une idée très simple qui de fait est un théorème : Si deux variables X et Y sont indépendantes, la fréquence de leur combinaison est le produit des fréquences marginales. On peut donc sur cette base, calculer leffectif attendu (expected frequency) puis le comparer à ce quon a observé pour chacune des cellules du tableau. On somme enfin ces écarts. \\[\\chi^2 = \\sum \\frac {(O_{ij} - E_{ij})^2}{E_{ij}}\\] Naturellement , une même valeur de cette quantité pour un petit tableau( 2x2) na pas la même signification que si le tableau est grand( par ex 20x 10). On lappréciera donc en fonction des degrés de liberté (n-1 x m-1). Le test proprement dit consiste à examiner quelles sont les chances quon obtienne la valeur du chi2 calculé, pour un nombre de degré de liberté donné. Si cette probabilité est faible on rejetera lhypothèse dindépendance des deux variables. Avec r la fonction chsq.test nous simplifie chi2&lt;-chisq.test(t) chi2 ## ## Pearson&#39;s Chi-squared test ## ## data: t ## X-squared = 23.853, df = 12, p-value = 0.0213 Lobjet ch2 est une liste # On isole les éléments qui nous intéresse #library() chi&lt;-round(chi2$statistic,2) p&lt;-round(chi2$p.value,3) V&lt;-cramerV(t, digit=3) 5.4.4.3 diagramme en mosaique library(ggmosaic) g1 &lt;- ggplot(data = foo) + geom_mosaic(aes(x=product( revenu ,habitat), fill = revenu))+ theme(axis.text.x = element_text(angle = 45, hjust = -0.1, vjust = -0.2))+ theme(legend.position = &quot;none&quot;)+ labs(title=&quot;Statut vaccinal \\npar genre&quot;, subtitle=paste0(&quot;chi2 =&quot;,chi, &quot; p = &quot;, p, &quot; - V : &quot;, V))+ scale_fill_brewer(palette = &quot;RdYlGn&quot;, direction = -1) g1 5.4.4.4 les chi2s partiel et des cartes de chaleur. Une carte de chaleur représente une grandeur par un gradient de couleur pour chaque cellule définie par des variable x et y. Faisons un premier essai pour représenter les effectifs, plutôt quavoir un tableau de nombres on va obtenir un tableau de couleurs. Larbre qui apparait en ligne et en colonne correspond au résultat dune classification hiérarchiques que nous développons dans le chapitre X. library(pheatmap) library(viridis) table2&lt;-as.data.frame(t) %&gt;% pivot_wider(names_from = Var1, values_from = Freq) %&gt;% column_to_rownames( var = &quot;Var2&quot;) pheatmap(table2 , color = rocket(10,direction =-1)) On utilise la même technique mais en représenant une grandeur différentes : les tests du chi2 partiels, pour apprécier les sous ou les sur-représentation. library(RColorBrewer) chi2df&lt;- as.data.frame(chi2$stdres) table2&lt;-chi2df %&gt;% pivot_wider(names_from = Var1, values_from = Freq) %&gt;% column_to_rownames( var = &quot;Var2&quot;) pheatmap(table2 , color = brewer.pal(n = 9, name = &quot;RdBu&quot;)) 5.4.4.5 Les treemaps, cest merveilleux Dautre graphiques et des emboitements library(treemapify) tree1&lt;-df %&gt;% mutate(n=1)%&gt;%group_by(cntry,genre,habitat) %&gt;% summarize(n=sum(n),mean=mean(trust_interpersonnel, na.rm=TRUE)) g10 &lt;- ggplot(tree1, aes(area = n, fill=genre,subgroup=cntry)) + geom_treemap() + geom_treemap_text(aes(label=habitat),colour = &quot;white&quot;, place = &quot;centre&quot;,grow = FALSE)+ geom_treemap_subgroup_text(color=&quot;white&quot;,grow = FALSE)+ geom_treemap_subgroup_border() g10 "],["analyse-graphique-multivariée.html", "Chapitre 6 Analyse graphique multivariée 6.1 Radar plot 6.2 Tableau de corrélation 6.3 facettes( qq quanti) 6.4 cowplot", " Chapitre 6 Analyse graphique multivariée Dans ce chapitre, on généralise à des ensembles de variables. 6.1 Radar plot rad&lt;-df %&gt;% group_by (habitat,cntry) %&gt;% summarize(Partis=mean(Partis, na.rm=TRUE), Parlement=mean(Parlement, na.rm=TRUE), Politiques=mean(Politiques, na.rm=TRUE), Police=mean(Police, na.rm=TRUE), Justice=mean(Justice, na.rm=TRUE), NationsUnies=mean(NationsUnies, na.rm=TRUE), ParlementEurop=mean(ParlementEurop, na.rm=TRUE)) %&gt;% filter(!is.na(habitat)) %&gt;% gather(variable, value, -habitat, -cntry) ggplot(rad, aes(x=reorder(variable, value),y=value, group=habitat))+ geom_line(aes(color=habitat), size=2)+ facet_grid(.~cntry) +coord_flip()+ scale_color_brewer(type=&quot;div&quot;,palette=3)+labs(title= &quot;Les éléments de la confiance institutionnelle&quot;, caption=&quot;ESS2002-2018&quot;,y= &quot;confiance (de 1 à 10)&quot;,x=&quot;institutions&quot;) rad&lt;-df %&gt;% group_by (Year,cntry) %&gt;% summarize(Partis=mean(Partis, na.rm=TRUE), Parlement=mean(Parlement, na.rm=TRUE), Politiques=mean(Politiques, na.rm=TRUE), Police=mean(Police, na.rm=TRUE), Justice=mean(Justice, na.rm=TRUE), NationsUnies=mean(NationsUnies, na.rm=TRUE), ParlementEurop=mean(ParlementEurop, na.rm=TRUE)) %&gt;% gather(variable, value, -Year, -cntry) ggplot(rad, aes(x=Year,y=value, group=variable))+ geom_line(aes(color=variable), size=1.2)+ facet_wrap(.~cntry, nrow=1) + scale_color_brewer(palette=&quot;Spectral&quot;)+labs(title= &quot;Les éléments de la confiance institutionnelle&quot;, caption=&quot;ESS2002-2018&quot;,y= &quot;confiance (de 1 à 10)&quot;,x=&quot;institutions&quot;) La différence entre les deux pays est claire, la rupture est accusée plus fortement en france quen allemagne. Lexplication nest sans doute pas culturelle mais démographique, un coup doeil à la carte des densité permet de comprendre mieux : https://www.populationdata.net/cartes/allemagne-france-densite-de-population-2011/. library(fmsb) rad&lt;-df %&gt;% filter(cntry==&quot;FR&quot;) %&gt;% group_by (habitat) %&gt;% summarize(Partis=mean(Partis, na.rm=TRUE), Parlement=mean(Parlement, na.rm=TRUE), Politiques=mean(Politiques, na.rm=TRUE), Police=mean(Police, na.rm=TRUE), Justice=mean(Justice, na.rm=TRUE), NationsUnies=mean(NationsUnies, na.rm=TRUE), ParlementEurop=mean(ParlementEurop, na.rm=TRUE)) %&gt;% filter(!is.na(habitat)) %&gt;% dplyr::select(-habitat) #on doit indiquer les valeurs minimale et maximale - la fonction rep permet de repeter (ici 7 fois pour les 7 variables/col) data &lt;- rbind(rep(7,7) , rep(3,7) , rad) #l&#39;autre method c&#39;est ce choisir maxmin=FALSE rownames(rad) &lt;- c(&quot;big city&quot;, &quot;suburbs&quot; ,&quot;town&quot;,&quot;village&quot;, &quot;countryside&quot;) radarchart(rad, axistype=0, seg=4, title=&quot;Moyenne par institution&quot;, maxmin=FALSE) legend(x=0.7, y=1, legend = rownames(rad), bty = &quot;n&quot;,text.col = &quot;grey&quot;, cex=1.2, pt.cex=3) 6.2 Tableau de corrélation 6.3 facettes( qq quanti) 6.4 cowplot "],["references.html", "References", " References "]]
