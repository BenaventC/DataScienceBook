<!DOCTYPE html>
<html lang="" xml:lang="">
<head>

  <meta charset="utf-8" />
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <title>Chapitre 5 Une introduction à ggplot | Introduction aux Data Sciences</title>
  <meta name="description" content="Mon cours d’analyse de donnée et de data science" />
  <meta name="generator" content="bookdown 0.22.3 and GitBook 2.6.7" />

  <meta property="og:title" content="Chapitre 5 Une introduction à ggplot | Introduction aux Data Sciences" />
  <meta property="og:type" content="book" />
  
  
  <meta property="og:description" content="Mon cours d’analyse de donnée et de data science" />
  <meta name="github-repo" content="rstudio/bookdown-demo" />

  <meta name="twitter:card" content="summary" />
  <meta name="twitter:title" content="Chapitre 5 Une introduction à ggplot | Introduction aux Data Sciences" />
  
  <meta name="twitter:description" content="Mon cours d’analyse de donnée et de data science" />
  

<meta name="author" content="Christophe Benavent - Université Paris Dauphine" />


<meta name="date" content="2021-08-12" />

  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="black" />
  
  
<link rel="prev" href="prise-en-main.html"/>
<link rel="next" href="analyse-graphique-multivariée.html"/>
<script src="libs/jquery-2.2.3/jquery.min.js"></script>
<link href="libs/gitbook-2.6.7/css/style.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-table.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-bookdown.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-highlight.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-search.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-fontsettings.css" rel="stylesheet" />
<link href="libs/gitbook-2.6.7/css/plugin-clipboard.css" rel="stylesheet" />









<link href="libs/anchor-sections-1.0.1/anchor-sections.css" rel="stylesheet" />
<script src="libs/anchor-sections-1.0.1/anchor-sections.js"></script>


<style type="text/css">
a.sourceLine { display: inline-block; line-height: 1.25; }
a.sourceLine { pointer-events: none; color: inherit; text-decoration: inherit; }
a.sourceLine:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode { white-space: pre; position: relative; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
code.sourceCode { white-space: pre-wrap; }
a.sourceLine { text-indent: -1em; padding-left: 1em; }
}
pre.numberSource a.sourceLine
  { position: relative; left: -4em; }
pre.numberSource a.sourceLine::before
  { content: attr(title);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; pointer-events: all; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
    color: #aaaaaa;
  }
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa;  padding-left: 4px; }
div.sourceCode
  {  }
@media screen {
a.sourceLine::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } /* Alert */
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code span.at { color: #7d9029; } /* Attribute */
code span.bn { color: #40a070; } /* BaseN */
code span.bu { } /* BuiltIn */
code span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code span.ch { color: #4070a0; } /* Char */
code span.cn { color: #880000; } /* Constant */
code span.co { color: #60a0b0; font-style: italic; } /* Comment */
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code span.do { color: #ba2121; font-style: italic; } /* Documentation */
code span.dt { color: #902000; } /* DataType */
code span.dv { color: #40a070; } /* DecVal */
code span.er { color: #ff0000; font-weight: bold; } /* Error */
code span.ex { } /* Extension */
code span.fl { color: #40a070; } /* Float */
code span.fu { color: #06287e; } /* Function */
code span.im { } /* Import */
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
code span.kw { color: #007020; font-weight: bold; } /* Keyword */
code span.op { color: #666666; } /* Operator */
code span.ot { color: #007020; } /* Other */
code span.pp { color: #bc7a00; } /* Preprocessor */
code span.sc { color: #4070a0; } /* SpecialChar */
code span.ss { color: #bb6688; } /* SpecialString */
code span.st { color: #4070a0; } /* String */
code span.va { color: #19177c; } /* Variable */
code span.vs { color: #4070a0; } /* VerbatimString */
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
</style>


<link rel="stylesheet" href="style.css" type="text/css" />
</head>

<body>



  <div class="book without-animation with-summary font-size-2 font-family-1" data-basepath=".">

    <div class="book-summary">
      <nav role="navigation">

<ul class="summary">
<li><a href="./">NLP en r et en français</a></li>

<li class="divider"></li>
<li class="chapter" data-level="1" data-path="index.html"><a href="index.html"><i class="fa fa-check"></i><b>1</b> Préface</a></li>
<li class="chapter" data-level="2" data-path="plan-et-outils-du-manuel.html"><a href="plan-et-outils-du-manuel.html"><i class="fa fa-check"></i><b>2</b> Plan et outils du manuel</a><ul>
<li class="chapter" data-level="2.1" data-path="plan-et-outils-du-manuel.html"><a href="plan-et-outils-du-manuel.html#les-jeux-de-données"><i class="fa fa-check"></i><b>2.1</b> Les jeux de données</a></li>
<li class="chapter" data-level="2.2" data-path="plan-et-outils-du-manuel.html"><a href="plan-et-outils-du-manuel.html#le-cadre-technique"><i class="fa fa-check"></i><b>2.2</b> Le cadre technique</a></li>
<li class="chapter" data-level="2.3" data-path="plan-et-outils-du-manuel.html"><a href="plan-et-outils-du-manuel.html#a-faire"><i class="fa fa-check"></i><b>2.3</b> A faire</a></li>
</ul></li>
<li class="chapter" data-level="3" data-path="intro.html"><a href="intro.html"><i class="fa fa-check"></i><b>3</b> Introduction</a><ul>
<li class="chapter" data-level="3.1" data-path="intro.html"><a href="intro.html#science-ou-technique"><i class="fa fa-check"></i><b>3.1</b> Science ou technique ?</a></li>
<li class="chapter" data-level="3.2" data-path="intro.html"><a href="intro.html#histoires-des-logiciels-statistiques"><i class="fa fa-check"></i><b>3.2</b> histoires des logiciels statistiques</a></li>
<li class="chapter" data-level="3.3" data-path="intro.html"><a href="intro.html#le-processus-de-traitement-des-données"><i class="fa fa-check"></i><b>3.3</b> Le processus de traitement des données</a></li>
<li class="chapter" data-level="3.4" data-path="intro.html"><a href="intro.html#les-facteurs-de-développement-des-datasciences"><i class="fa fa-check"></i><b>3.4</b> Les facteurs de développement des datasciences</a><ul>
<li class="chapter" data-level="3.4.1" data-path="intro.html"><a href="intro.html#une-lingua-franca"><i class="fa fa-check"></i><b>3.4.1</b> Une lingua franca</a></li>
<li class="chapter" data-level="3.4.2" data-path="intro.html"><a href="intro.html#une-communauté"><i class="fa fa-check"></i><b>3.4.2</b> Une communauté</a></li>
<li class="chapter" data-level="3.4.3" data-path="intro.html"><a href="intro.html#la-multiplication-des-sources-de-données."><i class="fa fa-check"></i><b>3.4.3</b> La multiplication des sources de données.</a></li>
</ul></li>
<li class="chapter" data-level="3.5" data-path="intro.html"><a href="intro.html#du-ml-à-lia"><i class="fa fa-check"></i><b>3.5</b> du ML à l’IA</a></li>
</ul></li>
<li class="chapter" data-level="4" data-path="prise-en-main.html"><a href="prise-en-main.html"><i class="fa fa-check"></i><b>4</b> Prise en main</a><ul>
<li class="chapter" data-level="4.1" data-path="prise-en-main.html"><a href="prise-en-main.html#la-convention-du-rmarkdown"><i class="fa fa-check"></i><b>4.1</b> La convention du Rmarkdown</a></li>
<li class="chapter" data-level="4.2" data-path="prise-en-main.html"><a href="prise-en-main.html#lire-les-données"><i class="fa fa-check"></i><b>4.2</b> Lire les données</a><ul>
<li class="chapter" data-level="4.2.1" data-path="prise-en-main.html"><a href="prise-en-main.html#le-cas-usuels-des-.csv"><i class="fa fa-check"></i><b>4.2.1</b> le cas usuels des *.csv</a></li>
<li class="chapter" data-level="4.2.2" data-path="prise-en-main.html"><a href="prise-en-main.html#la-diversité-des-formats"><i class="fa fa-check"></i><b>4.2.2</b> La diversité des formats</a></li>
</ul></li>
<li class="chapter" data-level="4.3" data-path="prise-en-main.html"><a href="prise-en-main.html#les-accès-directs"><i class="fa fa-check"></i><b>4.3</b> Les accès directs</a></li>
<li class="chapter" data-level="4.4" data-path="prise-en-main.html"><a href="prise-en-main.html#dplyr-pour-manipuler-les-données"><i class="fa fa-check"></i><b>4.4</b> <code>Dplyr</code> pour manipuler les données</a><ul>
<li class="chapter" data-level="4.4.1" data-path="prise-en-main.html"><a href="prise-en-main.html#des-pipes"><i class="fa fa-check"></i><b>4.4.1</b> Des pipes %&gt;%</a></li>
<li class="chapter" data-level="4.4.2" data-path="prise-en-main.html"><a href="prise-en-main.html#des-verbes"><i class="fa fa-check"></i><b>4.4.2</b> Des verbes</a></li>
</ul></li>
<li class="chapter" data-level="4.5" data-path="prise-en-main.html"><a href="prise-en-main.html#pour-aller-plus-loin"><i class="fa fa-check"></i><b>4.5</b> Pour aller plus loin</a></li>
<li class="chapter" data-level="4.6" data-path="prise-en-main.html"><a href="prise-en-main.html#etude-de-cas"><i class="fa fa-check"></i><b>4.6</b> Etude de cas</a></li>
</ul></li>
<li class="chapter" data-level="5" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html"><i class="fa fa-check"></i><b>5</b> Une introduction à ggplot</a><ul>
<li class="chapter" data-level="5.1" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html#la-grammaire-des-graphiques"><i class="fa fa-check"></i><b>5.1</b> La grammaire des graphiques</a><ul>
<li class="chapter" data-level="5.1.1" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html#un-modèle-en-couche"><i class="fa fa-check"></i><b>5.1.1</b> Un modèle en couche</a></li>
<li class="chapter" data-level="5.1.2" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html#une-typologie-des-représentations"><i class="fa fa-check"></i><b>5.1.2</b> Une typologie des représentations</a></li>
<li class="chapter" data-level="5.1.3" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html#lesthétique"><i class="fa fa-check"></i><b>5.1.3</b> L’esthétique</a></li>
</ul></li>
<li class="chapter" data-level="5.2" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html#une-étude-de-cas"><i class="fa fa-check"></i><b>5.2</b> Une étude de cas</a></li>
<li class="chapter" data-level="5.3" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html#analyse-univariée"><i class="fa fa-check"></i><b>5.3</b> Analyse univariée</a><ul>
<li class="chapter" data-level="5.3.1" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html#le-cas-des-variables-quantitatives"><i class="fa fa-check"></i><b>5.3.1</b> Le cas des variables quantitatives</a></li>
<li class="chapter" data-level="5.3.2" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html#quand-la-variable-est-qualitative"><i class="fa fa-check"></i><b>5.3.2</b> Quand la variable est qualitative</a></li>
</ul></li>
<li class="chapter" data-level="5.4" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html#analyse-bivariée"><i class="fa fa-check"></i><b>5.4</b> Analyse bivariée</a><ul>
<li class="chapter" data-level="5.4.1" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html#diagrammes-xy---la-magie-des-corrélations"><i class="fa fa-check"></i><b>5.4.1</b> Diagrammes xy - la magie des corrélations</a></li>
<li class="chapter" data-level="5.4.2" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html#comparer-les-distributions"><i class="fa fa-check"></i><b>5.4.2</b> Comparer les distributions</a></li>
<li class="chapter" data-level="5.4.3" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html#comparaison-de-moyennes"><i class="fa fa-check"></i><b>5.4.3</b> Comparaison de moyennes</a></li>
<li class="chapter" data-level="5.4.4" data-path="une-introduction-à-ggplot.html"><a href="une-introduction-à-ggplot.html#deux-variables-qualitatives"><i class="fa fa-check"></i><b>5.4.4</b> Deux variables qualitatives</a></li>
</ul></li>
</ul></li>
<li class="chapter" data-level="6" data-path="analyse-graphique-multivariée.html"><a href="analyse-graphique-multivariée.html"><i class="fa fa-check"></i><b>6</b> Analyse graphique multivariée</a><ul>
<li class="chapter" data-level="6.1" data-path="analyse-graphique-multivariée.html"><a href="analyse-graphique-multivariée.html#radar-plot"><i class="fa fa-check"></i><b>6.1</b> Radar plot</a></li>
<li class="chapter" data-level="6.2" data-path="analyse-graphique-multivariée.html"><a href="analyse-graphique-multivariée.html#tableau-de-corrélation"><i class="fa fa-check"></i><b>6.2</b> Tableau de corrélation</a></li>
<li class="chapter" data-level="6.3" data-path="analyse-graphique-multivariée.html"><a href="analyse-graphique-multivariée.html#facettes-qq-quanti"><i class="fa fa-check"></i><b>6.3</b> facettes( qq quanti)</a></li>
<li class="chapter" data-level="6.4" data-path="analyse-graphique-multivariée.html"><a href="analyse-graphique-multivariée.html#cowplot"><i class="fa fa-check"></i><b>6.4</b> cowplot</a></li>
</ul></li>
<li class="chapter" data-level="" data-path="references.html"><a href="references.html"><i class="fa fa-check"></i>References</a></li>
<li class="divider"></li>
<li><a href="https://github.com/rstudio/bookdown" target="blank">Published with bookdown</a></li>

</ul>

      </nav>
    </div>

    <div class="book-body">
      <div class="body-inner">
        <div class="book-header" role="navigation">
          <h1>
            <i class="fa fa-circle-o-notch fa-spin"></i><a href="./">Introduction aux Data Sciences</a>
          </h1>
        </div>

        <div class="page-wrapper" tabindex="-1" role="main">
          <div class="page-inner">

            <section class="normal" id="section-">
<div id="une-introduction-à-ggplot" class="section level1">
<h1><span class="header-section-number">Chapitre 5</span> Une introduction à ggplot</h1>
<p>Nous avons appris à lire des données, à les manipuler, nous avons le droit d’être pressé de les représenter de manière immédiatement lisible, par des dataviz.</p>
<p>On présente d’abord rapidement le concept de grammaire des graphiques</p>
<p>On se cncentre ensuite sur un cas d’étude</p>
<p>On décline.</p>
<div id="la-grammaire-des-graphiques" class="section level2">
<h2><span class="header-section-number">5.1</span> La grammaire des graphiques</h2>
<p>C’est sans doute une des percées conceptuelles laplus intéressante des datasciences. La représentation graphhiques des données fait l’objet à la fois d’une explosion créative mais aussi d’une synthèse théorique. C’est l’apport de la grammaire des graphiques.</p>
<p>Ces outils s’appuient sur l’idée de <a href="https://www.goodreads.com/book/show/2549408.The_Grammar_of_Graphics">grammaire des graphiques</a>. En voici un <a href="https://cfss.uchicago.edu/notes/grammar-of-graphics/">clair résumé</a>.En français il y a toujours le <a href="http://larmarange.github.io/analyse-R/intro-ggplot2.html">larmarange</a></p>
<div id="un-modèle-en-couche" class="section level3">
<h3><span class="header-section-number">5.1.1</span> Un modèle en couche</h3>
<p>Celle-ci met un ordre dans les éléments qui composent un graphique et les superpose.</p>
<div class="figure">
<img src="Images/graphiclayers.png" alt="layers" />
<p class="caption">layers</p>
</div>
<ul>
<li>l’aesthetic definit les éléments que l’on veut représenter : ce qu’on met en abscisse, ce qu’on met en ordonnné, les groupes que l’on veut distinguer.</li>
<li>la geométrie (geom_x)qui définit la forme de représentation</li>
<li>les échelles (scale_x)</li>
<li>Labelisation (labs)</li>
<li>les templates</li>
</ul>
<p>ggplot est construit selon cette structure. Voici le <a href="https://ggplot2-book.org/">book de référence</a></p>
<p>, qui est au centre de ce cours. On aura besoin de manière assez systématique de manipuler les données avant de les représenter, <a href="http://larmarange.github.io/analyse-R/manipuler-les-donnees-avec-dplyr.html">dplyr</a> nous permet de le faire aisément.</p>
</div>
<div id="une-typologie-des-représentations" class="section level3">
<h3><span class="header-section-number">5.1.2</span> Une typologie des représentations</h3>
<p>Un point de départ fondamental est la <a href="https://www.r-graph-gallery.com/">gallery de ggplot</a>,, elle présente de manière synthétique toute les types de figures qui peuvent être présentées. Avec du code facilement reproductible.</p>
<p>Une classification simple</p>
<ul>
<li>Analyse univariée</li>
<li>Analyse bi variée</li>
<li>Analyse multivariée
** les variables sont quantitatives : on analyse des matrices de corrélations
** les variables sont qualitatives : on analyse des tableaux croisés</li>
<li>Analyse geospatiale</li>
<li>Analyse de réseaux</li>
<li>analyse d’arbres</li>
<li>Diagramme de flux</li>
</ul>
</div>
<div id="lesthétique" class="section level3">
<h3><span class="header-section-number">5.1.3</span> L’esthétique</h3>
<p>L’ésthétique du diagramme dépends de ses lay out et de ses couleurs</p>
<div id="quelques-templates" class="section level4">
<h4><span class="header-section-number">5.1.3.1</span> Quelques templates</h4>
</div>
<div id="lart-des-palettes" class="section level4">
<h4><span class="header-section-number">5.1.3.2</span> l’art des palettes</h4>
<p>L’art des couleurs tient dans les palettes on aimera celles de Wes Anderson, on peut adorer fishualize. on trouvera</p>
</div>
</div>
</div>
<div id="une-étude-de-cas" class="section level2">
<h2><span class="header-section-number">5.2</span> Une étude de cas</h2>
<p>Les données sont extraites de l’ESS, une sélection est disponible <a href="">ici</a>. Elle couvre les 9 vagues et concernent la France et L’Allemagne. Les variables dépendantes (celles que l’on veut étudier et expliquer) sont les 9 items de la confiance, les variable considérées comme indépendantes (ou explicatives) sont une sélection de variables socio-démographiques : âge, genre, perception du pouvoir d’achat, orientation politique, type d’habitat.</p>
<p>On fait quelques opérations de recodage et on renomme les variables avoir une lecture plus aisée des variables et de leurs catégories.</p>
<p>On appele au début les bibliothèques. ggplot - dont voici le <a href="https://ggplot2-book.org/">book de référence</a>, qui est au centre de ce cours,</p>
</div>
<div id="analyse-univariée" class="section level2">
<h2><span class="header-section-number">5.3</span> Analyse univariée</h2>
<p>L’analyse univarié, comme son nom l’indique, ne s’intéresse qu’à une seule variable. Celle-ci peut être <strong>quantitative</strong> ou <strong>qualitative</strong> etne comporter qu’un nombre limité de modalités entre lesquels aucune comparaison de grandeur ne peut être faite. Les premières ont le plus souvent dans r un format numeric, les autres correspondent au format <em>factor</em>.</p>
<div id="le-cas-des-variables-quantitatives" class="section level3">
<h3><span class="header-section-number">5.3.1</span> Le cas des variables quantitatives</h3>
<p>Les variables quantitatives décrivent une variable dont les valeurs décrivent les quantités d’une grandeur. Elle peuvent être discrètes (dénombrement du d’un nombre d’unités) - le nombre d’habitant), ou continue (le nombre de km parcourus). l’<strong>histogramme</strong> est l’outil de base pour représenter la distribution d’une telle variable. Il représente pour des intervalles de valeurs donnés, la fréquence des observations.</p>
<p>Sa syntaxe simple comporte d’abord la définition de la variable et de la source de données, puis une des “géométrie” de ggplot : la fonction geom_histogram. Dans notre exemple, on va représenter le score de confiance institutionnelle pour la France en se concentrant sur la dernière vague d’enquête.</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1"><span class="co">#On charge le fichier recodé à la fin du chapitre précédent</span></a>
<a class="sourceLine" id="cb9-2" title="2">df&lt;-<span class="kw">readRDS</span>(<span class="st">&quot;./data/dfTrust.rds)&quot;</span>)</a>
<a class="sourceLine" id="cb9-3" title="3"></a>
<a class="sourceLine" id="cb9-4" title="4"><span class="co">#filtrage sur 2018 et la France.</span></a>
<a class="sourceLine" id="cb9-5" title="5"></a>
<a class="sourceLine" id="cb9-6" title="6">foo&lt;-df<span class="op">%&gt;%</span><span class="kw">filter</span>(Year<span class="op">==</span><span class="st">&quot;2018&quot;</span> <span class="op">&amp;</span><span class="st"> </span>cntry<span class="op">==</span><span class="st">&quot;FR&quot;</span> <span class="op">&amp;</span><span class="st"> </span><span class="op">!</span><span class="kw">is.na</span>(trust_institut))</a>
<a class="sourceLine" id="cb9-7" title="7"></a>
<a class="sourceLine" id="cb9-8" title="8"><span class="co"># on stocke le diagramme dans l&#39;objet g00, pour le réutiliser ultérieurement et pouvoir le compléter.</span></a>
<a class="sourceLine" id="cb9-9" title="9">g00&lt;-<span class="kw">ggplot</span>(foo,<span class="kw">aes</span>(<span class="dt">x=</span>trust_institut))<span class="op">+</span></a>
<a class="sourceLine" id="cb9-10" title="10"><span class="st">  </span><span class="kw">geom_histogram</span>()</a>
<a class="sourceLine" id="cb9-11" title="11">g00</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/302-1.png" width="672" /></p>
<p>On va améliorer l’aspect en</p>
<ol style="list-style-type: lower-alpha">
<li>modifiant la couleur et la largeur des barres,</li>
<li>ajoutant un thème,</li>
<li>en précisant les éléments textuels (titres, label)</li>
<li>en calculcant et en représentant la valeur moyenne.</li>
</ol>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" title="1"><span class="co">#on calcule la moyenne</span></a>
<a class="sourceLine" id="cb10-2" title="2">moy=<span class="kw">mean</span>(foo<span class="op">$</span>trust_institut, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb10-3" title="3"></a>
<a class="sourceLine" id="cb10-4" title="4"><span class="co">#avec tous les éléments</span></a>
<a class="sourceLine" id="cb10-5" title="5">g01 &lt;-<span class="kw">ggplot</span>(foo,<span class="kw">aes</span>(<span class="dt">x=</span>trust_institut))<span class="op">+</span></a>
<a class="sourceLine" id="cb10-6" title="6"><span class="st">  </span><span class="kw">geom_histogram</span>(<span class="dt">binwidth=</span><span class="dv">5</span>,<span class="dt">fill=</span><span class="st">&quot;pink&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb10-7" title="7"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span> <span class="st">&quot;Distribution de la confiance institutionnelle&quot;</span>, </a>
<a class="sourceLine" id="cb10-8" title="8">       <span class="dt">subtitle=</span> <span class="kw">paste0</span>(<span class="st">&quot;moyenne = &quot;</span>,<span class="kw">round</span>(moy,<span class="dv">2</span>)),</a>
<a class="sourceLine" id="cb10-9" title="9">       <span class="dt">caption=</span><span class="st">&quot;ESS2002-2018&quot;</span>,</a>
<a class="sourceLine" id="cb10-10" title="10">       <span class="dt">y=</span> <span class="st">&quot;frequence&quot;</span>,</a>
<a class="sourceLine" id="cb10-11" title="11">       <span class="dt">x=</span><span class="st">&quot;confiance (index de 0 à 100)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb10-12" title="12"><span class="st">    </span><span class="kw">geom_vline</span>(<span class="dt">xintercept=</span>moy, <span class="dt">color=</span><span class="st">&quot;red&quot;</span>,<span class="dt">size=</span><span class="fl">1.5</span>)</a>
<a class="sourceLine" id="cb10-13" title="13"></a>
<a class="sourceLine" id="cb10-14" title="14"></a>
<a class="sourceLine" id="cb10-15" title="15">g01</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/303-1.png" width="672" /></p>
<p>diagramme de densité : Au lieu de représenter les effectifs, on ramène l’effectif total à 1.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">g04&lt;-<span class="kw">ggplot</span>(foo,<span class="kw">aes</span>(<span class="dt">x=</span>trust_institut))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb11-2" title="2"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill=</span><span class="st">&quot;pink2&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb11-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span> <span class="st">&quot;Fonction de densité de probabilité&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;ESS2002-2018&quot;</span>,<span class="dt">y=</span> <span class="st">&quot;frequence&quot;</span>,<span class="dt">x=</span><span class="st">&quot;Confiance (index de 1 à 100)&quot;</span>) </a>
<a class="sourceLine" id="cb11-4" title="4">g04</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/304-1.png" width="672" /></p>
<p>enfin on peut examiner par rapport à une distribution théorique, en l’occurrence une distribution gaussienne, ou normale, de paramètres égaux à la moyenne et la variance empirique de la distribution. L’ajustement est convenable même si on observe une déviation sur la droite. C’est pourquoi on calcule aussi la Kurtosis et le skewness de la distribution.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1"><span class="co">#On a déjà calculé la moyenne : mean</span></a>
<a class="sourceLine" id="cb12-2" title="2"><span class="co">#il nous manque l&#39;écart-type et </span></a>
<a class="sourceLine" id="cb12-3" title="3">sd&lt;-<span class="kw">sd</span>(foo<span class="op">$</span>trust_institut, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb12-4" title="4"><span class="kw">library</span>(moments)</a>
<a class="sourceLine" id="cb12-5" title="5">sk&lt;-<span class="kw">skewness</span>(foo<span class="op">$</span>trust_institut)</a>
<a class="sourceLine" id="cb12-6" title="6">ks&lt;-<span class="kw">kurtosis</span>(foo<span class="op">$</span>trust_institut)</a>
<a class="sourceLine" id="cb12-7" title="7"></a>
<a class="sourceLine" id="cb12-8" title="8"></a>
<a class="sourceLine" id="cb12-9" title="9">g05&lt;-<span class="kw">ggplot</span>(foo,<span class="kw">aes</span>(<span class="dt">x=</span>trust_institut))<span class="op">+</span><span class="st">   </span></a>
<a class="sourceLine" id="cb12-10" title="10"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span> <span class="st">&quot;Distribution de la confiance institutionnelle&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;ESS2002-2018&quot;</span>,<span class="dt">y=</span> <span class="st">&quot;frequence&quot;</span>,<span class="dt">x=</span><span class="st">&quot;confiance (index de 0 à 100)&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb12-11" title="11"><span class="st">  </span><span class="kw">geom_density</span>(<span class="dt">fill=</span><span class="st">&quot;pink2&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb12-12" title="12"><span class="st">  </span><span class="kw">stat_function</span>(<span class="dt">fun =</span> dnorm,<span class="dt">color=</span><span class="st">&quot;red&quot;</span>,<span class="dt">size=</span><span class="fl">1.2</span>, <span class="dt">args =</span> <span class="kw">list</span>(<span class="dt">mean =</span>moy, <span class="dt">sd=</span>sd))</a>
<a class="sourceLine" id="cb12-13" title="13">   </a>
<a class="sourceLine" id="cb12-14" title="14">g05</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/305-1.png" width="672" /></p>
<p>Un grand classique du test de normalité d’une distribution est le diagramme QQ</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">g06 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(foo, <span class="kw">aes</span>(<span class="dt">sample =</span> trust_institut)) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-2" title="2"><span class="st">  </span><span class="kw">stat_qq</span>() <span class="op">+</span><span class="st"> </span><span class="kw">stat_qq_line</span>()<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb13-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span> <span class="st">&quot;QQplot confiance interpersonnelle&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;ESS2002-2018&quot;</span>,<span class="dt">y=</span> <span class="st">&quot;Echantillon&quot;</span>,<span class="dt">x=</span><span class="st">&quot;Théorique&quot;</span>) </a>
<a class="sourceLine" id="cb13-4" title="4">g06</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/306-1.png" width="672" /></p>
<p>On fini cette étude détaillée par l’ajustement d’abord d’un modèle (loi normale) aux données. Ensuite d’un modèle de mélange ( Mixture model) par lequel on défiit la loi de distribution sous jascente, comme un mélange entre deux populations normale de paramètres distincts.</p>
<p><a href="https://tinyheero.github.io/2015/10/13/mixture-model.html" class="uri">https://tinyheero.github.io/2015/10/13/mixture-model.html</a></p>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" title="1">df0&lt;-df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">na.omit</span>() </a>
<a class="sourceLine" id="cb14-2" title="2"><span class="kw">library</span>(MASS)</a>
<a class="sourceLine" id="cb14-3" title="3">fit&lt;-<span class="kw">fitdistr</span>(df0<span class="op">$</span>trust_interpersonnel,<span class="st">&quot;normal&quot;</span>) </a>
<a class="sourceLine" id="cb14-4" title="4">fit</a></code></pre></div>
<pre><code>##       mean           sd     
##   52.48548790   16.57617220 
##  ( 0.09344363) ( 0.06607462)</code></pre>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" title="1">g07&lt;-<span class="st"> </span>g05<span class="op">+</span><span class="kw">stat_function</span>(<span class="dt">fun =</span>  dnorm ,<span class="dt">color=</span><span class="st">&quot;orange&quot;</span>,<span class="dt">size=</span><span class="fl">1.2</span>, <span class="dt">args =</span> <span class="kw">list</span>( <span class="dt">mean=</span><span class="fl">52.48</span>,  <span class="dt">sd=</span><span class="fl">16.57</span>))</a>
<a class="sourceLine" id="cb16-2" title="2">g07</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/307-1.png" width="672" /></p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" title="1"><span class="kw">library</span>(mixtools)</a>
<a class="sourceLine" id="cb17-2" title="2">trust =<span class="st"> </span>foo<span class="op">$</span>trust_institut</a>
<a class="sourceLine" id="cb17-3" title="3">mixmdl =<span class="st"> </span><span class="kw">normalmixEM</span>(trust, <span class="dt">k=</span><span class="dv">2</span>)</a></code></pre></div>
<pre><code>## number of iterations= 513</code></pre>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" title="1">mixmdl<span class="op">$</span>mu</a></code></pre></div>
<pre><code>## [1] 39.23073 56.04167</code></pre>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" title="1">mixmdl<span class="op">$</span>sigma</a></code></pre></div>
<pre><code>## [1] 17.90246 10.56092</code></pre>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" title="1">mixmdl<span class="op">$</span>lambda</a></code></pre></div>
<pre><code>## [1] 0.6719506 0.3280494</code></pre>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" title="1"><span class="kw">plot</span>(mixmdl,<span class="dt">which=</span><span class="dv">2</span>)</a>
<a class="sourceLine" id="cb25-2" title="2"><span class="kw">lines</span>(<span class="kw">density</span>(trust), <span class="dt">lty=</span><span class="dv">2</span>, <span class="dt">lwd=</span><span class="dv">2</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/307-2.png" width="672" /></p>
<p>Finalement si notre distribution est univariée, car n’étudiant qu’une variable, on peut quand distinguer deux population distinctes.</p>
<div id="dautres-méthodes" class="section level4">
<h4><span class="header-section-number">5.3.1.1</span> D’autres méthodes</h4>
<p>boxplot</p>
<p>violin plot</p>
<p>barcode</p>
</div>
</div>
<div id="quand-la-variable-est-qualitative" class="section level3">
<h3><span class="header-section-number">5.3.2</span> Quand la variable est qualitative</h3>
<p>Quand la variable est qualitative, que ses variables sont discrètes, la manière de représenter la plus commune est le fameux camembert que les experts écartent. Un diagramme en barre représente mieux les proportions.</p>
<p>Un premier exemple pour représenter les vagues d’enquêtes</p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" title="1">g08&lt;-<span class="kw">ggplot</span>(df,<span class="kw">aes</span>(<span class="dt">x=</span>age))<span class="op">+</span></a>
<a class="sourceLine" id="cb26-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">fill=</span><span class="st">&quot;skyblue&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb26-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span> <span class="st">&quot;Evolution de la confiance interpersonnelle&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;ESS2002-2018&quot;</span>,<span class="dt">y=</span> <span class="st">&quot;frequence&quot;</span>,<span class="dt">x=</span><span class="st">&quot;Vague d&#39;enquête&quot;) </span></a>
<a class="sourceLine" id="cb26-4" title="4"><span class="st">g08</span></a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/308-1.png" width="672" /></p>
<p>en % et en 2 jeux de couleurs standard et couleur</p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" title="1">foo&lt;-df <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(age))</a>
<a class="sourceLine" id="cb27-2" title="2">g10&lt;-<span class="kw">ggplot</span>(foo,<span class="kw">aes</span>(<span class="dt">x=</span>age, <span class="dt">y =</span> <span class="kw">prop.table</span>(<span class="kw">stat</span>(count)),<span class="dt">label =</span> scales<span class="op">::</span><span class="kw">percent</span>(<span class="kw">prop.table</span>(<span class="kw">stat</span>(count)))))<span class="op">+</span></a>
<a class="sourceLine" id="cb27-3" title="3"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> age)) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb27-4" title="4"><span class="st">  </span><span class="kw">coord_flip</span>()<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb27-5" title="5"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span> <span class="st">&quot;Répartition de la population par classe d&#39;âge&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;ESS2002-2018&quot;</span>,<span class="dt">y=</span> <span class="st">&quot;%&quot;</span>,<span class="dt">x=</span><span class="st">&quot;classes d&#39;age&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb27-6" title="6"><span class="st">  </span><span class="kw">scale_y_continuous</span>(<span class="dt">labels =</span> scales<span class="op">::</span>percent)<span class="op">+</span></a>
<a class="sourceLine" id="cb27-7" title="7"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">stat =</span> <span class="st">&#39;count&#39;</span>,<span class="dt">position =</span> <span class="kw">position_dodge</span>(.<span class="dv">9</span>),  <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">3</span>) </a>
<a class="sourceLine" id="cb27-8" title="8"></a>
<a class="sourceLine" id="cb27-9" title="9"></a>
<a class="sourceLine" id="cb27-10" title="10">g10</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/309-1.png" width="672" /></p>
<p>si on tient au diagramme en cercle, autant opter pour un treemap avec la bibliothèque treemapifi</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" title="1">foo&lt;-df <span class="op">%&gt;%</span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(age))</a>
<a class="sourceLine" id="cb28-2" title="2">g10&lt;-<span class="kw">ggplot</span>(foo,<span class="kw">aes</span>(<span class="dt">x=</span><span class="st">&quot;&quot;</span>, <span class="dt">y =</span> <span class="kw">prop.table</span>(<span class="kw">stat</span>(count)),<span class="dt">label =</span> scales<span class="op">::</span><span class="kw">percent</span>(<span class="kw">prop.table</span>(<span class="kw">stat</span>(count)))))<span class="op">+</span></a>
<a class="sourceLine" id="cb28-3" title="3"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> age)) <span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb28-4" title="4"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span> <span class="st">&quot;Répartition de la population par classe d&#39;âge&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;ESS2002-2018&quot;</span>,<span class="dt">y=</span> <span class="st">&quot;%&quot;</span>,<span class="dt">x=</span><span class="st">&quot;classes d&#39;age&quot;</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb28-5" title="5"><span class="st">  </span><span class="kw">geom_text</span>(<span class="dt">stat =</span> <span class="st">&#39;count&#39;</span>,<span class="dt">position =</span> <span class="kw">position_dodge</span>(.<span class="dv">9</span>),  <span class="dt">hjust =</span> <span class="dv">1</span>, <span class="dt">size =</span> <span class="dv">3</span>) <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-6" title="6"><span class="st">  </span><span class="kw">coord_polar</span>(<span class="st">&quot;y&quot;</span>, <span class="dt">start=</span><span class="dv">0</span>)</a>
<a class="sourceLine" id="cb28-7" title="7"></a>
<a class="sourceLine" id="cb28-8" title="8"></a>
<a class="sourceLine" id="cb28-9" title="9"></a>
<a class="sourceLine" id="cb28-10" title="10">g10</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/310-1.png" width="672" />
<a href="https://cran.r-project.org/web/packages/treemapify/vignettes/introduction-to-treemapify.html" class="uri">https://cran.r-project.org/web/packages/treemapify/vignettes/introduction-to-treemapify.html</a></p>
<p>si on tient au diagramme en cercle, autant opter pour un treemap avec la bibliothèque treemapifi</p>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" title="1"><span class="kw">library</span>(treemapify)</a>
<a class="sourceLine" id="cb29-2" title="2">tree1&lt;-df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-3" title="3"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n=</span><span class="dv">1</span>)<span class="op">%&gt;%</span><span class="kw">group_by</span>(age) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb29-4" title="4"><span class="st">  </span><span class="kw">summarize</span>(<span class="dt">n=</span><span class="kw">sum</span>(n)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb29-5" title="5"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(age))</a>
<a class="sourceLine" id="cb29-6" title="6"></a>
<a class="sourceLine" id="cb29-7" title="7">g11 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(tree1, <span class="kw">aes</span>(<span class="dt">area =</span> n, <span class="dt">fill=</span>n),<span class="dt">label=</span>age) <span class="op">+</span></a>
<a class="sourceLine" id="cb29-8" title="8"><span class="st">  </span><span class="kw">geom_treemap</span>() <span class="op">+</span><span class="st">   </span><span class="kw">geom_treemap_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>age),<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">place =</span> <span class="st">&quot;centre&quot;</span>,<span class="dt">grow =</span> <span class="ot">TRUE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb29-9" title="9"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span> <span class="st">&quot;Répartition de la population par classe d&#39;âge&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;ESS2002-2018&quot;</span>,<span class="dt">y=</span> <span class="ot">NULL</span>,<span class="dt">x=</span><span class="ot">NULL</span>) </a>
<a class="sourceLine" id="cb29-10" title="10"></a>
<a class="sourceLine" id="cb29-11" title="11">g11</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/311-1.png" width="672" /></p>
</div>
</div>
<div id="analyse-bivariée" class="section level2">
<h2><span class="header-section-number">5.4</span> Analyse bivariée</h2>
<p>Comme son nom l’indique, il s’agit d’examiner la relation entre deux variables et d’étudier leur distribution conjointe.</p>
<ol style="list-style-type: lower-alpha">
<li>deux variables quantitatives</li>
<li>deux variable qualitatives</li>
<li>une variable quanti et une variable quali.</li>
</ol>
<div id="diagrammes-xy---la-magie-des-corrélations" class="section level3">
<h3><span class="header-section-number">5.4.1</span> Diagrammes xy - la magie des corrélations</h3>
<ol style="list-style-type: lower-alpha">
<li>par comparer des distribution de plusieurs groupes (variables catégorielles)</li>
<li>par comparer des moyennes d’une variable dépendante en fonction de plusieurs variables indépendantes catégorielle</li>
<li>mesurer l’association entre deux variables qualitatives</li>
</ol>
<p>venons en à analyser les relation entre deux variables quantitatives.</p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" title="1">foo&lt;-df <span class="op">%&gt;%</span><span class="kw">filter</span>(cntry<span class="op">==</span><span class="st">&quot;FR&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Year<span class="op">==</span><span class="st">&quot;2018&quot;</span>)</a>
<a class="sourceLine" id="cb30-2" title="2"></a>
<a class="sourceLine" id="cb30-3" title="3">g31&lt;-<span class="st"> </span><span class="kw">ggplot</span>(foo, <span class="kw">aes</span>(<span class="dt">x=</span> trust_interpersonnel,<span class="dt">y=</span>trust_institut)) <span class="op">+</span></a>
<a class="sourceLine" id="cb30-4" title="4"><span class="st">  </span><span class="kw">geom_point</span>( <span class="dt">size=</span><span class="fl">0.1</span>)</a>
<a class="sourceLine" id="cb30-5" title="5">     </a>
<a class="sourceLine" id="cb30-6" title="6">g31</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/312-1.png" width="672" />
Ce graphe est peu clair, il y a trop de points qui prennent des valeurs discrètes. Une astuce est de donner une position aléatoire pour sur disperser, on fait mieux apparaitre la densité de points. On ajoute la représentation de deux courbe d’ajustement, l’une linéraire et l’autre non linéaires.</p>
<p>Mais en attendant en voici un calcul élémentaire.</p>
<p>le calcul de la variance</p>
<p><span class="math display">\[{SS}_{xx} = \sum (x - \bar{x})^2 = \sum x^2 - \frac {(\sum x)^2}{n}\]</span>
le calcul de la covariance</p>
<p><span class="math display">\[{SS}_{xy} = \sum (x - \bar{x})(y - \bar{y}) = \sum xy - \frac {(\sum x)(\sum y)}{n}\]</span>
et la corrélation qui est le rapport de la covariance sur la racine carrée du produit des variances de x et y.</p>
<p><span class="math display">\[r = \frac {{SS}_{xy}}{\sqrt {{SS}_{xx}{SS}_{yy}}}\]</span></p>
<p>la corrélation est de l’ordre d’un peu plus 0,42 ce qui est assez élevé mais laisse une certaine indépendance des variables. Elle désignent des objets liés mais différents.</p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" title="1"><span class="co">#psych</span></a>
<a class="sourceLine" id="cb31-2" title="2">r&lt;-<span class="kw">cor.test</span>(foo<span class="op">$</span>trust_interpersonnel, foo<span class="op">$</span>trust_institut)</a>
<a class="sourceLine" id="cb31-3" title="3">rp&lt;-<span class="kw">round</span>(r<span class="op">$</span>estimate,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb31-4" title="4">rp</a></code></pre></div>
<pre><code>##   cor 
## 0.404</code></pre>
<p>Amélirons de grapf</p>
<div class="sourceCode" id="cb33"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb33-1" title="1"><span class="kw">library</span>(ggExtra)</a>
<a class="sourceLine" id="cb33-2" title="2">g32&lt;-<span class="kw">ggplot</span>(foo, <span class="kw">aes</span>(<span class="dt">x=</span> trust_interpersonnel,<span class="dt">y=</span>trust_institut)) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-3" title="3"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">size=</span><span class="fl">0.1</span>, <span class="dt">color=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb33-4" title="4"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;lm&quot;</span>, <span class="dt">se=</span><span class="ot">TRUE</span>) <span class="op">+</span></a>
<a class="sourceLine" id="cb33-5" title="5"><span class="st">  </span><span class="kw">geom_smooth</span>(<span class="dt">method=</span><span class="st">&quot;gam&quot;</span>,<span class="dt">color=</span><span class="st">&quot;red&quot;</span>)     <span class="op">+</span></a>
<a class="sourceLine" id="cb33-6" title="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Relation entre confiance </span><span class="ch">\n</span><span class="st">institutionnelle et interpersonnelle&quot;</span>, </a>
<a class="sourceLine" id="cb33-7" title="7">       <span class="dt">subtitle =</span> <span class="kw">paste</span>(<span class="st">&quot;r de pearson: &quot;</span>,rp ),</a>
<a class="sourceLine" id="cb33-8" title="8">       <span class="dt">x=</span> <span class="st">&quot;Confiance interpersonnelle&quot;</span>,</a>
<a class="sourceLine" id="cb33-9" title="9">       <span class="dt">y=</span><span class="st">&quot; Confiance institutionnelle&quot;</span>)</a>
<a class="sourceLine" id="cb33-10" title="10"></a>
<a class="sourceLine" id="cb33-11" title="11"><span class="kw">ggMarginal</span>(g32  ,<span class="dt">type =</span> <span class="st">&quot;density&quot;</span>, <span class="dt">fill =</span> <span class="st">&quot;Royalblue1&quot;</span>, <span class="dt">alpha=</span>.<span class="dv">5</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/315-1.png" width="672" /></p>
<p>on peut souhaiter ajouter une droite des moindre carrés (calculée pour chaque vague d’enquête pour évaluer la stabilité de la relation dans le temps). Les lignes sont parallèles, la corrélation ne change pas dans le temps, c’est une relation stable. Les deux formes de confiance vont dans le meme sens. On verra dans un autre chapitre comment calculer ces droites de corrélations.</p>
<p>Une autre représentation plus éclatée qui ne montre rien de plus que la régularité</p>
<p>Une autre façon de représenter est celle de carte de densité de probabilité.</p>
<div class="sourceCode" id="cb34"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb34-1" title="1">g32&lt;-<span class="kw">ggplot</span>(foo, <span class="kw">aes</span>(<span class="dt">x=</span> trust_interpersonnel,<span class="dt">y=</span>trust_institut)) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-2" title="2"><span class="st">  </span><span class="kw">geom_point</span>(<span class="dt">position =</span> <span class="st">&quot;jitter&quot;</span>, <span class="dt">size=</span><span class="fl">0.1</span>, <span class="dt">color=</span><span class="st">&quot;grey&quot;</span>)<span class="op">+</span><span class="kw">geom_density2d</span>()<span class="op">+</span></a>
<a class="sourceLine" id="cb34-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Relation entre confiance institutionnelle et interpersonnelles&quot;</span>, <span class="dt">subtitle =</span> <span class="kw">paste</span>(<span class="st">&quot;r de pearson: &quot;</span>,rp ))</a>
<a class="sourceLine" id="cb34-4" title="4">  </a>
<a class="sourceLine" id="cb34-5" title="5">g33&lt;-<span class="kw">ggplot</span>(foo, <span class="kw">aes</span>(<span class="dt">x=</span> trust_interpersonnel,<span class="dt">y=</span>trust_institut)) <span class="op">+</span></a>
<a class="sourceLine" id="cb34-6" title="6"><span class="st">  </span><span class="kw">geom_density2d_filled</span>(<span class="kw">aes</span>(<span class="dt">fill =</span> ..level.., <span class="dt">color =</span> ..level..),</a>
<a class="sourceLine" id="cb34-7" title="7">    <span class="dt">contour_var =</span> <span class="st">&quot;density&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb34-8" title="8"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title =</span> <span class="st">&quot;Relation entre confiance institutionnelle et interpersonnelles&quot;</span>, <span class="dt">subtitle =</span> <span class="kw">paste</span>(<span class="st">&quot;r de pearson: &quot;</span>,rp ))<span class="op">+</span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)</a>
<a class="sourceLine" id="cb34-9" title="9">  </a>
<a class="sourceLine" id="cb34-10" title="10"></a>
<a class="sourceLine" id="cb34-11" title="11"><span class="kw">plot_grid</span>(g32, g33, <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&#39;A&#39;</span>, <span class="st">&#39;B&#39;</span>), <span class="dt">label_size =</span> <span class="dv">12</span>)</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/316-1.png" width="672" /></p>
</div>
<div id="comparer-les-distributions" class="section level3">
<h3><span class="header-section-number">5.4.2</span> Comparer les distributions</h3>
<p>Dans notre base on a melangé les données de l’Allemagne et de la France. On va comparer leur distribution. Et tant qu’à faire, puisque qu’on a deux variables, on va faire deux comparaions.</p>
<p>A cette fin, nous construisons un tableau de donnée spécifique.</p>
<div class="sourceCode" id="cb35"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb35-1" title="1"><span class="co">#on recode en facteur la variable</span></a>
<a class="sourceLine" id="cb35-2" title="2"></a>
<a class="sourceLine" id="cb35-3" title="3">foo &lt;-<span class="st"> </span>df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-4" title="4"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(cntry,trust_institut, Year,trust_interpersonnel) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-5" title="5"><span class="st">  </span><span class="kw">filter</span>( Year<span class="op">==</span><span class="st">&quot;2018&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb35-6" title="6"><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>Year)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-7" title="7"><span class="st"> </span><span class="kw">drop_na</span>() <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb35-8" title="8"><span class="st">  </span><span class="kw">gather</span>(variable, value, <span class="op">-</span>cntry)</a>
<a class="sourceLine" id="cb35-9" title="9"></a>
<a class="sourceLine" id="cb35-10" title="10"></a>
<a class="sourceLine" id="cb35-11" title="11"><span class="co">#on peut utiliser &quot;facet&quot;</span></a>
<a class="sourceLine" id="cb35-12" title="12">g20&lt;-<span class="kw">ggplot</span>(foo,<span class="kw">aes</span>(<span class="dt">x=</span>value))<span class="op">+</span><span class="st"> </span><span class="kw">geom_density</span>(<span class="dt">binwidth=</span><span class="dv">10</span>, <span class="dt">fill=</span><span class="st">&quot;pink&quot;</span>)<span class="op">+</span><span class="st"> </span><span class="kw">facet_grid</span>(cntry<span class="op">~</span>variable)<span class="op">+</span><span class="st">   </span></a>
<a class="sourceLine" id="cb35-13" title="13"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span> <span class="st">&quot;Confiance institutionnnelle&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;ESS2002-2018&quot;</span>,<span class="dt">y=</span> <span class="st">&quot;frequence&quot;</span>,<span class="dt">x=</span><span class="st">&quot;Confiance&quot;</span>)</a>
<a class="sourceLine" id="cb35-14" title="14">g20</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/317-1.png" width="672" /></p>
<div class="sourceCode" id="cb36"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb36-1" title="1">g21&lt;-<span class="kw">ggplot</span>(foo,<span class="kw">aes</span>(<span class="dt">x=</span>variable, <span class="dt">y=</span>value))<span class="op">+</span><span class="st"> </span><span class="kw">geom_violin</span>( <span class="dt">fill=</span><span class="st">&quot;pink&quot;</span>) <span class="op">+</span><span class="st"> </span><span class="kw">geom_boxplot</span>(<span class="dt">width=</span><span class="fl">0.1</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb36-2" title="2"><span class="st">  </span><span class="kw">facet_grid</span>(cntry<span class="op">~</span>.)<span class="op">+</span><span class="st">   </span></a>
<a class="sourceLine" id="cb36-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span> <span class="st">&quot;Confiance institutionnnelle&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;ESS2002-2018&quot;</span>,<span class="dt">y=</span> <span class="st">&quot;frequence&quot;</span>,<span class="dt">x=</span><span class="st">&quot;Confiance&quot;</span>)</a>
<a class="sourceLine" id="cb36-4" title="4">g21</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/317-2.png" width="672" /></p>
</div>
<div id="comparaison-de-moyennes" class="section level3">
<h3><span class="header-section-number">5.4.3</span> Comparaison de moyennes</h3>
<p>ggplot traite les données qu’on lui donne. Avec les historgram on accède directement aux données. Si on souhaite représenter les moyennes et les comparer il faut une étape supplémentaire qui vise à calculer ce tableau de données : les valeurs de chacune des vague d’enquête.</p>
<div class="sourceCode" id="cb37"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb37-1" title="1">df_wave&lt;-df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">filter</span>(cntry<span class="op">==</span><span class="st">&quot;FR&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Year<span class="op">==</span><span class="st">&quot;2018&quot;</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-2" title="2"><span class="st">  </span><span class="kw">group_by</span>(revenu) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb37-3" title="3"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">trust_interpersonnel=</span><span class="kw">mean</span>(trust_interpersonnel, <span class="dt">na.rm=</span><span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb37-4" title="4">            <span class="dt">trust_institut =</span><span class="kw">mean</span>(trust_institut, <span class="dt">na.rm=</span><span class="ot">TRUE</span>)) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb37-5" title="5"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(revenu)) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">gather</span>(variable, value, <span class="op">-</span>revenu)</a>
<a class="sourceLine" id="cb37-6" title="6">df_wave</a></code></pre></div>
<pre><code>## # A tibble: 8 x 3
##   revenu                        variable             value
##   &lt;fct&gt;                         &lt;chr&gt;                &lt;dbl&gt;
## 1 Vie confortable               trust_interpersonnel  55.6
## 2 Se débrouille avec son revenu trust_interpersonnel  51.7
## 3 Revenu insuffisant            trust_interpersonnel  46.7
## 4 Revenu très insuffisant       trust_interpersonnel  41.4
## 5 Vie confortable               trust_institut        50.2
## 6 Se débrouille avec son revenu trust_institut        44.1
## 7 Revenu insuffisant            trust_institut        39.1
## 8 Revenu très insuffisant       trust_institut        34.5</code></pre>
<div class="sourceCode" id="cb39"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb39-1" title="1">g06a&lt;-<span class="kw">ggplot</span>(df_wave,<span class="kw">aes</span>(<span class="dt">x=</span>revenu,<span class="dt">y=</span>value, <span class="dt">group=</span>variable))<span class="op">+</span></a>
<a class="sourceLine" id="cb39-2" title="2"><span class="st">  </span><span class="kw">geom_bar</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="kw">aes</span>(<span class="dt">fill=</span>variable), <span class="dt">position =</span><span class="kw">position_dodge</span>())<span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb39-3" title="3"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span> <span class="st">&quot;Confiance institutionnnelle&quot;</span>, <span class="dt">caption=</span><span class="st">&quot;ESS2002-2018&quot;</span>,<span class="dt">y=</span> <span class="st">&quot;frequence&quot;</span>,<span class="dt">x=</span><span class="st">&quot;Confiance&quot;</span>)</a>
<a class="sourceLine" id="cb39-4" title="4"></a>
<a class="sourceLine" id="cb39-5" title="5">g06a</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/318-1.png" width="672" /></p>
<p>On a une solution mais pas la meilleure, on perd l’idée de variance et ce serait bien d’ajouter des barres d’intervalle de confiances , un diagramme en lignes serait plus élégant. On en profite pour corriger l’aspect des labels peu lisibles en les inclinants, et à choisir une échelle qui omettent les valeur supérieur à 70 et inférieure à 30 pour donner une vision plus respectueuses de la totalité de l’échelle qui va de 0 à 100.</p>
<p>Au passage on emploie à nouveau cowplot pour combiner les graphes, et ici plus précisément partager la légende des deux graphiques.</p>
<p>On observera que si le niveau de confiance diminue avec le revenu, la confiance interpersonnelle est plus forte, et de manière parallèle, à la confiance institutionnelle. On remarquera enfin que c’est pour les revenu les plus faibles que l’estimation est la plus imprécise ou la variance la plus grande.</p>
<div class="sourceCode" id="cb40"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb40-1" title="1">df_wave2&lt;-df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-2" title="2"><span class="st">  </span><span class="kw">filter</span>(cntry<span class="op">==</span><span class="st">&quot;FR&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Year<span class="op">==</span><span class="st">&quot;2018&quot;</span>)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb40-3" title="3"><span class="st">  </span><span class="kw">group_by</span>(revenu) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-4" title="4"><span class="st">  </span><span class="kw">mutate</span>(<span class="dt">n=</span><span class="dv">1</span>) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb40-5" title="5"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">trust_interpersonnel_se=</span><span class="kw">sd</span>(trust_interpersonnel, <span class="dt">na.rm=</span><span class="ot">TRUE</span>), <span class="co">#on calcule l&#39;écartype des deux variables</span></a>
<a class="sourceLine" id="cb40-6" title="6">            <span class="dt">trust_institut_se =</span><span class="kw">sd</span>(trust_institut, <span class="dt">na.rm=</span><span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb40-7" title="7">            <span class="dt">n=</span><span class="kw">sum</span>(n),</a>
<a class="sourceLine" id="cb40-8" title="8">            <span class="dt">trust_interpersonnel_se=</span> <span class="dv">2</span><span class="op">*</span>trust_interpersonnel_se<span class="op">/</span><span class="kw">sqrt</span>(n), <span class="co"># on calcule l&#39;erreur type d&#39;échantillonnage</span></a>
<a class="sourceLine" id="cb40-9" title="9">            <span class="dt">trust_institut_se=</span><span class="dv">2</span><span class="op">*</span>trust_institut_se<span class="op">/</span><span class="kw">sqrt</span>(n)</a>
<a class="sourceLine" id="cb40-10" title="10">            ) <span class="op">%&gt;%</span><span class="st"> </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>n) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb40-11" title="11"><span class="st">  </span><span class="kw">filter</span>(<span class="op">!</span><span class="kw">is.na</span>(revenu)) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-12" title="12"><span class="st">  </span><span class="kw">gather</span>(variable, value, <span class="op">-</span>revenu) <span class="op">%&gt;%</span><span class="st"> </span><span class="co">#on passe en format long</span></a>
<a class="sourceLine" id="cb40-13" title="13"><span class="st">  </span>dplyr<span class="op">::</span><span class="kw">select</span>(<span class="op">-</span>revenu,<span class="op">-</span>variable)<span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb40-14" title="14"><span class="st">  </span><span class="kw">rename</span>(<span class="dt">se=</span>value)</a>
<a class="sourceLine" id="cb40-15" title="15">  </a>
<a class="sourceLine" id="cb40-16" title="16">df_wave3&lt;-<span class="kw">cbind</span>(df_wave,df_wave2) <span class="co">#on concatène les moyennes et les erreurs types</span></a>
<a class="sourceLine" id="cb40-17" title="17"></a>
<a class="sourceLine" id="cb40-18" title="18"><span class="co">#on peut enfin produire le graphique</span></a>
<a class="sourceLine" id="cb40-19" title="19"></a>
<a class="sourceLine" id="cb40-20" title="20">g06a&lt;-<span class="kw">ggplot</span>(df_wave3,<span class="kw">aes</span>(<span class="dt">x=</span>revenu,<span class="dt">y=</span>value, <span class="dt">group=</span>variable))<span class="op">+</span></a>
<a class="sourceLine" id="cb40-21" title="21"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="kw">aes</span>(<span class="dt">color=</span>variable), <span class="dt">size=</span><span class="fl">1.5</span>)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-22" title="22"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>value<span class="op">-</span>se, <span class="dt">ymax=</span>value<span class="op">+</span>se, <span class="dt">color=</span>variable), <span class="dt">width=</span>.<span class="dv">2</span>,<span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="dv">0</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb40-23" title="23"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span> <span class="st">&quot;Confiance et revenu&quot;</span>,<span class="dt">y=</span> <span class="st">&quot;Moyenne&quot;</span>,<span class="dt">x=</span><span class="ot">NULL</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb40-24" title="24"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>( <span class="dt">angle=</span><span class="dv">45</span>, <span class="dt">hjust =</span><span class="dv">1</span>)) <span class="co">#on controle l&#39;angle et la position horizontale du label</span></a>
<a class="sourceLine" id="cb40-25" title="25"></a>
<a class="sourceLine" id="cb40-26" title="26">  </a>
<a class="sourceLine" id="cb40-27" title="27">g06b&lt;-<span class="kw">ggplot</span>(df_wave3,<span class="kw">aes</span>(<span class="dt">x=</span>revenu,<span class="dt">y=</span>value, <span class="dt">group=</span>variable))<span class="op">+</span></a>
<a class="sourceLine" id="cb40-28" title="28"><span class="st">  </span><span class="kw">geom_line</span>(<span class="dt">stat=</span><span class="st">&quot;identity&quot;</span>,<span class="kw">aes</span>(<span class="dt">color=</span>variable), <span class="dt">size=</span><span class="fl">1.5</span>)<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-29" title="29"><span class="st">  </span><span class="kw">geom_errorbar</span>(<span class="kw">aes</span>(<span class="dt">ymin=</span>value<span class="op">-</span>se, <span class="dt">ymax=</span>value<span class="op">+</span>se, <span class="dt">color=</span>variable), <span class="dt">width=</span>.<span class="dv">2</span>,<span class="dt">position=</span><span class="kw">position_dodge</span>(<span class="dv">0</span>))<span class="op">+</span></a>
<a class="sourceLine" id="cb40-30" title="30"><span class="st">  </span><span class="kw">ylim</span>(<span class="dv">0</span>,<span class="dv">100</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb40-31" title="31"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span> <span class="st">&quot;&quot;</span>,<span class="dt">y=</span> <span class="st">&quot;Moyenne&quot;</span>,<span class="dt">x=</span><span class="ot">NULL</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb40-32" title="32"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>( <span class="dt">angle=</span><span class="dv">45</span>, <span class="dt">hjust =</span><span class="dv">1</span>)) <span class="co">#on controle l&#39;angle et la position horizontale du label</span></a>
<a class="sourceLine" id="cb40-33" title="33"></a>
<a class="sourceLine" id="cb40-34" title="34">prow &lt;-<span class="st"> </span><span class="kw">plot_grid</span>(</a>
<a class="sourceLine" id="cb40-35" title="35">  g06a <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>),</a>
<a class="sourceLine" id="cb40-36" title="36">  g06b <span class="op">+</span><span class="st"> </span><span class="kw">theme</span>(<span class="dt">legend.position=</span><span class="st">&quot;none&quot;</span>),</a>
<a class="sourceLine" id="cb40-37" title="37">  <span class="dt">align =</span> <span class="st">&#39;vh&#39;</span>,</a>
<a class="sourceLine" id="cb40-38" title="38">  <span class="dt">labels =</span> <span class="kw">c</span>(<span class="st">&quot;A&quot;</span>, <span class="st">&quot;B&quot;</span>, <span class="st">&quot;C&quot;</span>),</a>
<a class="sourceLine" id="cb40-39" title="39">  <span class="dt">hjust =</span> <span class="dv">-1</span>,</a>
<a class="sourceLine" id="cb40-40" title="40">  <span class="dt">nrow =</span> <span class="dv">1</span></a>
<a class="sourceLine" id="cb40-41" title="41">)</a>
<a class="sourceLine" id="cb40-42" title="42"><span class="co"># extract a legend that is laid out horizontally</span></a>
<a class="sourceLine" id="cb40-43" title="43">legend_b &lt;-<span class="st"> </span><span class="kw">get_legend</span>(</a>
<a class="sourceLine" id="cb40-44" title="44">  g06a <span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb40-45" title="45"><span class="st">    </span><span class="kw">guides</span>(<span class="dt">color =</span> <span class="kw">guide_legend</span>(<span class="dt">nrow =</span> <span class="dv">1</span>)) <span class="op">+</span></a>
<a class="sourceLine" id="cb40-46" title="46"><span class="st">    </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;bottom&quot;</span>)</a>
<a class="sourceLine" id="cb40-47" title="47">)</a>
<a class="sourceLine" id="cb40-48" title="48"></a>
<a class="sourceLine" id="cb40-49" title="49"><span class="co"># add the legend underneath the row we made earlier. Give it 10%</span></a>
<a class="sourceLine" id="cb40-50" title="50"><span class="co"># of the height of one plot (via rel_heights).</span></a>
<a class="sourceLine" id="cb40-51" title="51"><span class="kw">plot_grid</span>(prow, legend_b, <span class="dt">ncol =</span> <span class="dv">1</span>, <span class="dt">rel_heights =</span> <span class="kw">c</span>(<span class="dv">1</span>, <span class="fl">.1</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/321-1.png" width="672" /></p>
<p>La visualisation est utile, encore faut-il qu’on soit bien certain que les variations ne soit pas le produit du hasard, de fluctuations d’échantillonnage. Si en moyenne la perception du pouvoir d’achat est associée à des moyennes de confiance décroissantes, les différences observées sont-elle significatives? Dans les représentations précédentes c’est le choix de l’échelle qui oriente l’analyse.</p>
<p>On a un besoin d’un test plus objectif.Celui est le classique test d’analyse de variance (ANOVA).</p>
<p>Celui-çi est le test d’analyse de variance qui consiste à comparer la variance à l’intérieur des groupes ( intra), et la variance entre les moyennes des groupes ( inter ou between).</p>
<div class="sourceCode" id="cb41"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb41-1" title="1">foo&lt;-df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb41-2" title="2"><span class="st">  </span><span class="kw">filter</span>(cntry<span class="op">==</span><span class="st">&quot;FR&quot;</span> <span class="op">&amp;</span><span class="st"> </span>Year<span class="op">==</span><span class="st">&quot;2018&quot;</span>) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">drop_na</span>()</a>
<a class="sourceLine" id="cb41-3" title="3">fit&lt;-<span class="kw">lm</span>(trust_institut<span class="op">~</span>revenu, foo)</a>
<a class="sourceLine" id="cb41-4" title="4"><span class="kw">anova</span>(fit)</a></code></pre></div>
<pre><code>## Analysis of Variance Table
## 
## Response: trust_institut
##             Df Sum Sq Mean Sq F value    Pr(&gt;F)    
## revenu       3  27651  9217.1  32.052 &lt; 2.2e-16 ***
## Residuals 1686 484846   287.6                      
## ---
## Signif. codes:  0 &#39;***&#39; 0.001 &#39;**&#39; 0.01 &#39;*&#39; 0.05 &#39;.&#39; 0.1 &#39; &#39; 1</code></pre>
<div class="sourceCode" id="cb43"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb43-1" title="1"><span class="kw">library</span>(xtable)</a>
<a class="sourceLine" id="cb43-2" title="2">ft &lt;-<span class="st"> </span><span class="kw">xtable_to_flextable</span>(<span class="kw">xtable</span>(<span class="kw">anova</span>(fit)), <span class="dt">hline.after =</span> <span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">2</span>))</a>
<a class="sourceLine" id="cb43-3" title="3">ft</a></code></pre></div>
<template id="45897496-efda-40fa-b45d-9c17276722ca"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-247ce7a8{border-collapse:collapse;}.cl-247219a4{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-247219a5{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-24724082{margin:0;text-align:left;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-24724083{margin:0;text-align:right;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-24728e7a{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e7b{width:52.6pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e7c{width:58.4pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e7d{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e7e{width:65.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e7f{width:69.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e80{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e81{width:58.4pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e82{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e83{width:52.6pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24728e84{width:65.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b56c{width:69.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b56d{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b56e{width:52.6pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b56f{width:65.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b570{width:58.4pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b571{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-2472b572{width:69.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-247ce7a8'>
<thead><tr style="overflow-wrap:break-word;"><td class="cl-2472b571"><p class="cl-24724082"><span class="cl-247219a4"></span></p></td><td class="cl-2472b56d"><p class="cl-24724083"><span class="cl-247219a4">Df</span></p></td><td class="cl-2472b572"><p class="cl-24724083"><span class="cl-247219a4">Sum Sq</span></p></td><td class="cl-2472b56f"><p class="cl-24724083"><span class="cl-247219a4">Mean Sq</span></p></td><td class="cl-2472b570"><p class="cl-24724083"><span class="cl-247219a4">F value</span></p></td><td class="cl-2472b56e"><p class="cl-24724083"><span class="cl-247219a4">Pr(&gt;F)</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td class="cl-24728e7d"><p class="cl-24724082"><span class="cl-247219a4">revenu</span></p></td><td class="cl-24728e7a"><p class="cl-24724083"><span class="cl-247219a5">3</span></p></td><td class="cl-24728e7f"><p class="cl-24724083"><span class="cl-247219a5">27,651.4</span></p></td><td class="cl-24728e7e"><p class="cl-24724083"><span class="cl-247219a5">9,217.1</span></p></td><td class="cl-24728e7c"><p class="cl-24724083"><span class="cl-247219a5">32.1</span></p></td><td class="cl-24728e7b"><p class="cl-24724083"><span class="cl-247219a5">0.0</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24728e82"><p class="cl-24724082"><span class="cl-247219a4">Residuals</span></p></td><td class="cl-24728e80"><p class="cl-24724083"><span class="cl-247219a5">1,686</span></p></td><td class="cl-2472b56c"><p class="cl-24724083"><span class="cl-247219a5">484,845.7</span></p></td><td class="cl-24728e84"><p class="cl-24724083"><span class="cl-247219a5">287.6</span></p></td><td class="cl-24728e81"><p class="cl-24724083"><span class="cl-247219a5"></span></p></td><td class="cl-24728e83"><p class="cl-24724083"><span class="cl-247219a5"></span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="fc65a8f2-cf74-46c8-927f-ae9308bece77"></div>
<script>
var dest = document.getElementById("fc65a8f2-cf74-46c8-927f-ae9308bece77");
var template = document.getElementById("45897496-efda-40fa-b45d-9c17276722ca");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<div class="sourceCode" id="cb44"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb44-1" title="1"><span class="co">#library(jtools)</span></a>
<a class="sourceLine" id="cb44-2" title="2"><span class="co">#summ(fit)</span></a>
<a class="sourceLine" id="cb44-3" title="3"><span class="co">#effect_plot(fit, pred=&quot;revenu&quot;)</span></a></code></pre></div>
</div>
<div id="deux-variables-qualitatives" class="section level3">
<h3><span class="header-section-number">5.4.4</span> Deux variables qualitatives</h3>
<p>L’étude de la relation éventuelle entre deux variables qualitative s’apprécie traditionnellement par une méthode de tableau croisé.</p>
<div id="tableau-croisé" class="section level4">
<h4><span class="header-section-number">5.4.4.1</span> Tableau croisé</h4>
<p>Pour calculer le tableau croisé on utilise la fonction très simple <code>table</code>.</p>
<div class="sourceCode" id="cb45"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb45-1" title="1">t&lt;-<span class="kw">table</span>(foo<span class="op">$</span>revenu,foo<span class="op">$</span>habitat)</a>
<a class="sourceLine" id="cb45-2" title="2">t</a></code></pre></div>
<pre><code>##                                
##                                 Big city Suburbs Town Village Countryside
##   Vie confortable                    118      82  161     142          31
##   Se débrouille avec son revenu      120     109  275     227          58
##   Revenu insuffisant                  48      38  129      88          22
##   Revenu très insuffisant              9       5   18      10           0</code></pre>
<div class="sourceCode" id="cb47"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb47-1" title="1"><span class="kw">prop.table</span>(t,<span class="dv">2</span>)</a></code></pre></div>
<pre><code>##                                
##                                   Big city    Suburbs       Town    Village
##   Vie confortable               0.40000000 0.35042735 0.27615780 0.30406852
##   Se débrouille avec son revenu 0.40677966 0.46581197 0.47169811 0.48608137
##   Revenu insuffisant            0.16271186 0.16239316 0.22126930 0.18843683
##   Revenu très insuffisant       0.03050847 0.02136752 0.03087479 0.02141328
##                                
##                                 Countryside
##   Vie confortable                0.27927928
##   Se débrouille avec son revenu  0.52252252
##   Revenu insuffisant             0.19819820
##   Revenu très insuffisant        0.00000000</code></pre>
<p>Mais ce n’est pas esthétique, de flextable : <code>proc_freq</code>. Elle nous donne en peu de mots les effectif par cellule, les pourcentages en lignes, et en colonnes.</p>
<div class="sourceCode" id="cb49"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb49-1" title="1">ft1&lt;-<span class="st"> </span><span class="kw">proc_freq</span>(foo, <span class="st">&quot;revenu&quot;</span>, <span class="st">&quot;habitat&quot;</span>, <span class="dt">include.table_percent =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb49-2" title="2">                <span class="dt">include.row_percent =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb49-3" title="3">  <span class="dt">include.column_percent =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb49-4" title="4">ft1</a></code></pre></div>
<template id="b06b8cdb-9a2b-495a-baa7-fa51ac0538fb"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-24cf160e{border-collapse:collapse;}.cl-24c3371c{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-24c3371d{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-24c35e0e{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-24c35e0f{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-24c3d2f8{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2f9{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2fa{width:168.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2fb{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2fc{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2fd{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2fe{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d2ff{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d300{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d301{width:168.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3d302{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e0{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e1{width:168.5pt;background-color:transparent;vertical-align: top;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e2{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e3{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e4{width:168.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e5{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e6{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e7{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e8{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9e9{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c3f9ea{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c420dc{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c420dd{width:168.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24c420de{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-24cf160e'>
<thead><tr style="overflow-wrap:break-word;"><td  colspan="2"class="cl-24c3f9e4"><p class="cl-24c35e0e"><span class="cl-24c3371c"></span></p></td><td  colspan="6"class="cl-24c3f9e5"><p class="cl-24c35e0e"><span class="cl-24c3371c">habitat</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24c420dd"><p class="cl-24c35e0e"><span class="cl-24c3371c">revenu</span></p></td><td class="cl-24c420dc"><p class="cl-24c35e0e"><span class="cl-24c3371c">label</span></p></td><td class="cl-24c3f9e9"><p class="cl-24c35e0e"><span class="cl-24c3371c">Big city</span></p></td><td class="cl-24c3f9e9"><p class="cl-24c35e0e"><span class="cl-24c3371c">Suburbs</span></p></td><td class="cl-24c3f9e9"><p class="cl-24c35e0e"><span class="cl-24c3371c">Town</span></p></td><td class="cl-24c3f9e9"><p class="cl-24c35e0e"><span class="cl-24c3371c">Village</span></p></td><td class="cl-24c3f9ea"><p class="cl-24c35e0e"><span class="cl-24c3371c">Countryside</span></p></td><td class="cl-24c420de"><p class="cl-24c35e0e"><span class="cl-24c3371c">Total</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-24c3d2fa"><p class="cl-24c35e0f"><span class="cl-24c3371c">Vie confortable</span></p></td><td class="cl-24c3d2f8"><p class="cl-24c35e0e"><span class="cl-24c3371d">Frequency</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">118</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">82</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">161</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">142</span></p></td><td class="cl-24c3d2fb"><p class="cl-24c35e0e"><span class="cl-24c3371d">31</span></p></td><td class="cl-24c3d2f9"><p class="cl-24c35e0e"><span class="cl-24c3371d">534</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24c3d300"><p class="cl-24c35e0e"><span class="cl-24c3371d">Col Pct</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">40%</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">35.04%</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">27.62%</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">30.41%</span></p></td><td class="cl-24c3d2fe"><p class="cl-24c35e0e"><span class="cl-24c3371d">27.93%</span></p></td><td class="cl-24c3d2fd"><p class="cl-24c35e0e"><span class="cl-24c3371d"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-24c3d2fa"><p class="cl-24c35e0f"><span class="cl-24c3371c">Se débrouille avec son revenu</span></p></td><td class="cl-24c3d2f8"><p class="cl-24c35e0e"><span class="cl-24c3371d">Frequency</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">120</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">109</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">275</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">227</span></p></td><td class="cl-24c3d2fb"><p class="cl-24c35e0e"><span class="cl-24c3371d">58</span></p></td><td class="cl-24c3d2f9"><p class="cl-24c35e0e"><span class="cl-24c3371d">789</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24c3d300"><p class="cl-24c35e0e"><span class="cl-24c3371d">Col Pct</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">40.68%</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">46.58%</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">47.17%</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">48.61%</span></p></td><td class="cl-24c3d2fe"><p class="cl-24c35e0e"><span class="cl-24c3371d">52.25%</span></p></td><td class="cl-24c3d2fd"><p class="cl-24c35e0e"><span class="cl-24c3371d"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-24c3d2fa"><p class="cl-24c35e0f"><span class="cl-24c3371c">Revenu insuffisant</span></p></td><td class="cl-24c3d2f8"><p class="cl-24c35e0e"><span class="cl-24c3371d">Frequency</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">48</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">38</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">129</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">88</span></p></td><td class="cl-24c3d2fb"><p class="cl-24c35e0e"><span class="cl-24c3371d">22</span></p></td><td class="cl-24c3d2f9"><p class="cl-24c35e0e"><span class="cl-24c3371d">325</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24c3d300"><p class="cl-24c35e0e"><span class="cl-24c3371d">Col Pct</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">16.27%</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">16.24%</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">22.13%</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">18.84%</span></p></td><td class="cl-24c3d2fe"><p class="cl-24c35e0e"><span class="cl-24c3371d">19.82%</span></p></td><td class="cl-24c3d2fd"><p class="cl-24c35e0e"><span class="cl-24c3371d"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-24c3d2fa"><p class="cl-24c35e0f"><span class="cl-24c3371c">Revenu très insuffisant</span></p></td><td class="cl-24c3d2f8"><p class="cl-24c35e0e"><span class="cl-24c3371d">Frequency</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">9</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">5</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">18</span></p></td><td class="cl-24c3d2fc"><p class="cl-24c35e0e"><span class="cl-24c3371d">10</span></p></td><td class="cl-24c3d2fb"><p class="cl-24c35e0e"><span class="cl-24c3371d">0</span></p></td><td class="cl-24c3d2f9"><p class="cl-24c35e0e"><span class="cl-24c3371d">42</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24c3d300"><p class="cl-24c35e0e"><span class="cl-24c3371d">Col Pct</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">3.05%</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">2.14%</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">3.09%</span></p></td><td class="cl-24c3d2ff"><p class="cl-24c35e0e"><span class="cl-24c3371d">2.14%</span></p></td><td class="cl-24c3d2fe"><p class="cl-24c35e0e"><span class="cl-24c3371d">0%</span></p></td><td class="cl-24c3d2fd"><p class="cl-24c35e0e"><span class="cl-24c3371d"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24c3f9e1"><p class="cl-24c35e0f"><span class="cl-24c3371c">Total</span></p></td><td class="cl-24c3f9e0"><p class="cl-24c35e0e"><span class="cl-24c3371d">Frequency</span></p></td><td class="cl-24c3d302"><p class="cl-24c35e0e"><span class="cl-24c3371d">295</span></p></td><td class="cl-24c3d302"><p class="cl-24c35e0e"><span class="cl-24c3371d">234</span></p></td><td class="cl-24c3d302"><p class="cl-24c35e0e"><span class="cl-24c3371d">583</span></p></td><td class="cl-24c3d302"><p class="cl-24c35e0e"><span class="cl-24c3371d">467</span></p></td><td class="cl-24c3f9e2"><p class="cl-24c35e0e"><span class="cl-24c3371d">111</span></p></td><td class="cl-24c3f9e3"><p class="cl-24c35e0e"><span class="cl-24c3371d">1690</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="38b5a660-db06-40ae-bd1c-7ae0f58e50a7"></div>
<script>
var dest = document.getElementById("38b5a660-db06-40ae-bd1c-7ae0f58e50a7");
var template = document.getElementById("b06b8cdb-9a2b-495a-baa7-fa51ac0538fb");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

<div class="sourceCode" id="cb50"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb50-1" title="1">ft2&lt;-<span class="st"> </span><span class="kw">proc_freq</span>(foo, <span class="st">&quot;revenu&quot;</span>, <span class="st">&quot;habitat&quot;</span>, <span class="dt">include.table_percent =</span> <span class="ot">FALSE</span>,</a>
<a class="sourceLine" id="cb50-2" title="2">                <span class="dt">include.row_percent =</span> <span class="ot">TRUE</span>,</a>
<a class="sourceLine" id="cb50-3" title="3">  <span class="dt">include.column_percent =</span> <span class="ot">FALSE</span>)</a>
<a class="sourceLine" id="cb50-4" title="4">ft2</a></code></pre></div>
<template id="ca7d544b-9eb6-4130-9b6a-2d97d38d9b6c"><style>
.tabwid table{
  border-collapse:collapse;
  line-height:1;
  margin-left:auto;
  margin-right:auto;
  border-width: 0;
  display: table;
  margin-top: 1.275em;
  margin-bottom: 1.275em;
  border-spacing: 0;
  border-color: transparent;
}
.tabwid_left table{
  margin-left:0;
}
.tabwid_right table{
  margin-right:0;
}
.tabwid td {
    padding: 0;
}
.tabwid a {
  text-decoration: none;
}
.tabwid thead {
    background-color: transparent;
}
.tabwid tfoot {
    background-color: transparent;
}
.tabwid table tr {
background-color: transparent;
}
</style><div class="tabwid"><style>.cl-250accbc{border-collapse:collapse;}.cl-24fa0f4e{font-family:'Arial';font-size:11pt;font-weight:bold;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-24fa0f4f{font-family:'Arial';font-size:11pt;font-weight:normal;font-style:normal;text-decoration:none;color:rgba(0, 0, 0, 1.00);background-color:transparent;}.cl-24fa3640{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-24fa3641{margin:0;text-align:center;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);padding-bottom:5pt;padding-top:5pt;padding-left:5pt;padding-right:5pt;line-height: 1;background-color:transparent;}.cl-24fa842e{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa842f{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8430{width:168.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8431{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8432{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8433{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8434{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8435{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8436{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8437{width:168.5pt;background-color:transparent;vertical-align: top;border-bottom: 0 solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fa8438{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab20{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab21{width:168.5pt;background-color:transparent;vertical-align: top;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab22{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab23{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(102, 102, 102, 1.00);border-top: 1pt solid rgba(102, 102, 102, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab24{width:168.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab25{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab26{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab27{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab28{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 1pt solid rgba(0, 0, 0, 1.00);border-top: 0 solid rgba(255, 255, 255, 0.00);border-left: 0 solid rgba(255, 255, 255, 0.00);border-right: 0 solid rgba(255, 255, 255, 0.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab29{width:84.8pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24faab2a{width:90.9pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fad212{width:72.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fad213{width:168.5pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}.cl-24fad214{width:48.1pt;background-color:transparent;vertical-align: middle;border-bottom: 2pt solid rgba(0, 0, 0, 1.00);border-top: 1pt solid rgba(0, 0, 0, 1.00);border-left: 0 solid rgba(0, 0, 0, 1.00);border-right: 0 solid rgba(0, 0, 0, 1.00);margin-bottom:0;margin-top:0;margin-left:0;margin-right:0;}</style><table class='cl-250accbc'>
<thead><tr style="overflow-wrap:break-word;"><td  colspan="2"class="cl-24faab24"><p class="cl-24fa3640"><span class="cl-24fa0f4e"></span></p></td><td  colspan="6"class="cl-24faab25"><p class="cl-24fa3640"><span class="cl-24fa0f4e">habitat</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24fad213"><p class="cl-24fa3640"><span class="cl-24fa0f4e">revenu</span></p></td><td class="cl-24fad212"><p class="cl-24fa3640"><span class="cl-24fa0f4e">label</span></p></td><td class="cl-24faab29"><p class="cl-24fa3640"><span class="cl-24fa0f4e">Big city</span></p></td><td class="cl-24faab29"><p class="cl-24fa3640"><span class="cl-24fa0f4e">Suburbs</span></p></td><td class="cl-24faab29"><p class="cl-24fa3640"><span class="cl-24fa0f4e">Town</span></p></td><td class="cl-24faab29"><p class="cl-24fa3640"><span class="cl-24fa0f4e">Village</span></p></td><td class="cl-24faab2a"><p class="cl-24fa3640"><span class="cl-24fa0f4e">Countryside</span></p></td><td class="cl-24fad214"><p class="cl-24fa3640"><span class="cl-24fa0f4e">Total</span></p></td></tr></thead><tbody><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-24fa8430"><p class="cl-24fa3641"><span class="cl-24fa0f4e">Vie confortable</span></p></td><td class="cl-24fa842e"><p class="cl-24fa3640"><span class="cl-24fa0f4f">Frequency</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">118</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">82</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">161</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">142</span></p></td><td class="cl-24fa8431"><p class="cl-24fa3640"><span class="cl-24fa0f4f">31</span></p></td><td class="cl-24fa842f"><p class="cl-24fa3640"><span class="cl-24fa0f4f">534</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24fa8436"><p class="cl-24fa3640"><span class="cl-24fa0f4f">Row Pct</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">22.1%</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">15.36%</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">30.15%</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">26.59%</span></p></td><td class="cl-24fa8434"><p class="cl-24fa3640"><span class="cl-24fa0f4f">5.81%</span></p></td><td class="cl-24fa8433"><p class="cl-24fa3640"><span class="cl-24fa0f4f"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-24fa8430"><p class="cl-24fa3641"><span class="cl-24fa0f4e">Se débrouille avec son revenu</span></p></td><td class="cl-24fa842e"><p class="cl-24fa3640"><span class="cl-24fa0f4f">Frequency</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">120</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">109</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">275</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">227</span></p></td><td class="cl-24fa8431"><p class="cl-24fa3640"><span class="cl-24fa0f4f">58</span></p></td><td class="cl-24fa842f"><p class="cl-24fa3640"><span class="cl-24fa0f4f">789</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24fa8436"><p class="cl-24fa3640"><span class="cl-24fa0f4f">Row Pct</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">15.21%</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">13.81%</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">34.85%</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">28.77%</span></p></td><td class="cl-24fa8434"><p class="cl-24fa3640"><span class="cl-24fa0f4f">7.35%</span></p></td><td class="cl-24fa8433"><p class="cl-24fa3640"><span class="cl-24fa0f4f"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-24fa8430"><p class="cl-24fa3641"><span class="cl-24fa0f4e">Revenu insuffisant</span></p></td><td class="cl-24fa842e"><p class="cl-24fa3640"><span class="cl-24fa0f4f">Frequency</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">48</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">38</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">129</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">88</span></p></td><td class="cl-24fa8431"><p class="cl-24fa3640"><span class="cl-24fa0f4f">22</span></p></td><td class="cl-24fa842f"><p class="cl-24fa3640"><span class="cl-24fa0f4f">325</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24fa8436"><p class="cl-24fa3640"><span class="cl-24fa0f4f">Row Pct</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">14.77%</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">11.69%</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">39.69%</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">27.08%</span></p></td><td class="cl-24fa8434"><p class="cl-24fa3640"><span class="cl-24fa0f4f">6.77%</span></p></td><td class="cl-24fa8433"><p class="cl-24fa3640"><span class="cl-24fa0f4f"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td  rowspan="2"class="cl-24fa8430"><p class="cl-24fa3641"><span class="cl-24fa0f4e">Revenu très insuffisant</span></p></td><td class="cl-24fa842e"><p class="cl-24fa3640"><span class="cl-24fa0f4f">Frequency</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">9</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">5</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">18</span></p></td><td class="cl-24fa8432"><p class="cl-24fa3640"><span class="cl-24fa0f4f">10</span></p></td><td class="cl-24fa8431"><p class="cl-24fa3640"><span class="cl-24fa0f4f">0</span></p></td><td class="cl-24fa842f"><p class="cl-24fa3640"><span class="cl-24fa0f4f">42</span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24fa8436"><p class="cl-24fa3640"><span class="cl-24fa0f4f">Row Pct</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">21.43%</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">11.9%</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">42.86%</span></p></td><td class="cl-24fa8435"><p class="cl-24fa3640"><span class="cl-24fa0f4f">23.81%</span></p></td><td class="cl-24fa8434"><p class="cl-24fa3640"><span class="cl-24fa0f4f">0%</span></p></td><td class="cl-24fa8433"><p class="cl-24fa3640"><span class="cl-24fa0f4f"></span></p></td></tr><tr style="overflow-wrap:break-word;"><td class="cl-24faab21"><p class="cl-24fa3641"><span class="cl-24fa0f4e">Total</span></p></td><td class="cl-24faab20"><p class="cl-24fa3640"><span class="cl-24fa0f4f">Frequency</span></p></td><td class="cl-24fa8438"><p class="cl-24fa3640"><span class="cl-24fa0f4f">295</span></p></td><td class="cl-24fa8438"><p class="cl-24fa3640"><span class="cl-24fa0f4f">234</span></p></td><td class="cl-24fa8438"><p class="cl-24fa3640"><span class="cl-24fa0f4f">583</span></p></td><td class="cl-24fa8438"><p class="cl-24fa3640"><span class="cl-24fa0f4f">467</span></p></td><td class="cl-24faab22"><p class="cl-24fa3640"><span class="cl-24fa0f4f">111</span></p></td><td class="cl-24faab23"><p class="cl-24fa3640"><span class="cl-24fa0f4f">1690</span></p></td></tr></tbody></table></div></template>
<div class="flextable-shadow-host" id="8c8915da-d7a4-4515-b76f-a44e8442c782"></div>
<script>
var dest = document.getElementById("8c8915da-d7a4-4515-b76f-a44e8442c782");
var template = document.getElementById("ca7d544b-9eb6-4130-9b6a-2d97d38d9b6c");
var caption = template.content.querySelector("caption");
if(caption) {
  caption.style.cssText = "display:block;text-align:center;";
  var newcapt = document.createElement("p");
  newcapt.appendChild(caption)
  dest.parentNode.insertBefore(newcapt, dest.previousSibling);
}
var fantome = dest.attachShadow({mode: 'open'});
var templateContent = template.content;
fantome.appendChild(templateContent);
</script>

</div>
<div id="le-valeureux-chi²" class="section level4">
<h4><span class="header-section-number">5.4.4.2</span> le valeureux chi²</h4>
<p>Le test du chi2 s’appuie sur une idée très simple qui de fait est un théorème : Si deux variables X et Y sont indépendantes, la fréquence de leur combinaison est le produit des fréquences marginales.</p>
<p>On peut donc sur cette base, calculer l’effectif attendu (expected frequency) puis le comparer à ce qu’on a observé pour chacune des cellules du tableau. On somme enfin ces écarts.</p>
<p><span class="math display">\[\chi^2 = \sum \frac {(O_{ij} - E_{ij})^2}{E_{ij}}\]</span></p>
<p>Naturellement , une même valeur de cette quantité pour un petit tableau( 2x2) n’a pas la même signification que si le tableau est grand( par ex 20x 10). On l’appréciera donc en fonction des degrés de liberté (n-1 x m-1).</p>
<p>Le test proprement dit consiste à examiner quelles sont les chances qu’on obtienne la valeur du chi2 calculé, pour un nombre de degré de liberté donné. Si cette probabilité est faible on rejetera l’hypothèse d’indépendance des deux variables.</p>
<p>Avec r la fonction chsq.test nous simplifie</p>
<div class="sourceCode" id="cb51"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb51-1" title="1">chi2&lt;-<span class="kw">chisq.test</span>(t)</a>
<a class="sourceLine" id="cb51-2" title="2">chi2</a></code></pre></div>
<pre><code>## 
##  Pearson&#39;s Chi-squared test
## 
## data:  t
## X-squared = 23.853, df = 12, p-value = 0.0213</code></pre>
<p>L’objet ch2 est une liste</p>
<div class="sourceCode" id="cb53"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb53-1" title="1"><span class="co"># On isole les éléments qui nous intéresse</span></a>
<a class="sourceLine" id="cb53-2" title="2"></a>
<a class="sourceLine" id="cb53-3" title="3"><span class="co">#library()</span></a>
<a class="sourceLine" id="cb53-4" title="4">chi&lt;-<span class="kw">round</span>(chi2<span class="op">$</span>statistic,<span class="dv">2</span>)</a>
<a class="sourceLine" id="cb53-5" title="5">p&lt;-<span class="kw">round</span>(chi2<span class="op">$</span>p.value,<span class="dv">3</span>)</a>
<a class="sourceLine" id="cb53-6" title="6">V&lt;-<span class="kw">cramerV</span>(t, <span class="dt">digit=</span><span class="dv">3</span>)</a></code></pre></div>
</div>
<div id="diagramme-en-mosaique" class="section level4">
<h4><span class="header-section-number">5.4.4.3</span> diagramme en mosaique</h4>
<div class="sourceCode" id="cb54"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb54-1" title="1"><span class="kw">library</span>(ggmosaic)</a>
<a class="sourceLine" id="cb54-2" title="2">g1 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(<span class="dt">data =</span> foo) <span class="op">+</span></a>
<a class="sourceLine" id="cb54-3" title="3"><span class="st">  </span><span class="kw">geom_mosaic</span>(<span class="kw">aes</span>(<span class="dt">x=</span><span class="kw">product</span>( revenu ,habitat), <span class="dt">fill =</span> revenu))<span class="op">+</span><span class="st">  </span></a>
<a class="sourceLine" id="cb54-4" title="4"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">axis.text.x =</span> <span class="kw">element_text</span>(<span class="dt">angle =</span> <span class="dv">45</span>, <span class="dt">hjust =</span> <span class="fl">-0.1</span>, <span class="dt">vjust =</span> <span class="fl">-0.2</span>))<span class="op">+</span><span class="st"> </span></a>
<a class="sourceLine" id="cb54-5" title="5"><span class="st">  </span><span class="kw">theme</span>(<span class="dt">legend.position =</span> <span class="st">&quot;none&quot;</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb54-6" title="6"><span class="st">  </span><span class="kw">labs</span>(<span class="dt">title=</span><span class="st">&quot;Statut vaccinal </span><span class="ch">\n</span><span class="st">par genre&quot;</span>, </a>
<a class="sourceLine" id="cb54-7" title="7">       <span class="dt">subtitle=</span><span class="kw">paste0</span>(<span class="st">&quot;chi2 =&quot;</span>,chi, <span class="st">&quot; p = &quot;</span>, p, <span class="st">&quot; - V : &quot;</span>, V))<span class="op">+</span><span class="st">    </span></a>
<a class="sourceLine" id="cb54-8" title="8"><span class="st">  </span><span class="kw">scale_fill_brewer</span>(<span class="dt">palette =</span> <span class="st">&quot;RdYlGn&quot;</span>, <span class="dt">direction =</span> <span class="dv">-1</span>) </a>
<a class="sourceLine" id="cb54-9" title="9"></a>
<a class="sourceLine" id="cb54-10" title="10">g1</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/327-1.png" width="672" /></p>
</div>
<div id="les-chi2s-partiel-et-des-cartes-de-chaleur." class="section level4">
<h4><span class="header-section-number">5.4.4.4</span> les chi2s partiel et des cartes de chaleur.</h4>
<p>Une carte de chaleur représente une grandeur par un gradient de couleur pour chaque cellule définie par des variable x et y.</p>
<p>Faisons un premier essai pour représenter les effectifs, plutôt qu’avoir un tableau de nombres on va obtenir un tableau de couleurs.</p>
<p>L’arbre qui apparait en ligne et en colonne correspond au résultat d’une classification hiérarchiques que nous développons dans le chapitre X.</p>
<div class="sourceCode" id="cb55"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb55-1" title="1"><span class="kw">library</span>(pheatmap)</a>
<a class="sourceLine" id="cb55-2" title="2"><span class="kw">library</span>(viridis)</a>
<a class="sourceLine" id="cb55-3" title="3"></a>
<a class="sourceLine" id="cb55-4" title="4">table2&lt;-<span class="kw">as.data.frame</span>(t) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb55-5" title="5"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> Var1, <span class="dt">values_from =</span> Freq) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb55-6" title="6"><span class="st">  </span><span class="kw">column_to_rownames</span>( <span class="dt">var =</span> <span class="st">&quot;Var2&quot;</span>)</a>
<a class="sourceLine" id="cb55-7" title="7"><span class="kw">pheatmap</span>(table2 , <span class="dt">color =</span> <span class="kw">rocket</span>(<span class="dv">10</span>,<span class="dt">direction =</span><span class="op">-</span><span class="dv">1</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/328-1.png" width="672" /></p>
<p>On utilise la même technique mais en représenant une grandeur différentes : les tests du chi2 partiels, pour apprécier les sous ou les sur-représentation.</p>
<div class="sourceCode" id="cb56"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb56-1" title="1"><span class="kw">library</span>(RColorBrewer)</a>
<a class="sourceLine" id="cb56-2" title="2">chi2df&lt;-<span class="st"> </span><span class="kw">as.data.frame</span>(chi2<span class="op">$</span>stdres)</a>
<a class="sourceLine" id="cb56-3" title="3"></a>
<a class="sourceLine" id="cb56-4" title="4">table2&lt;-chi2df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb56-5" title="5"><span class="st">  </span><span class="kw">pivot_wider</span>(<span class="dt">names_from =</span> Var1, <span class="dt">values_from =</span> Freq) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb56-6" title="6"><span class="st">  </span><span class="kw">column_to_rownames</span>( <span class="dt">var =</span> <span class="st">&quot;Var2&quot;</span>)</a>
<a class="sourceLine" id="cb56-7" title="7"><span class="kw">pheatmap</span>(table2 , <span class="dt">color =</span> <span class="kw">brewer.pal</span>(<span class="dt">n =</span> <span class="dv">9</span>, <span class="dt">name =</span> <span class="st">&quot;RdBu&quot;</span>))</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/329-1.png" width="672" /></p>
</div>
<div id="les-treemaps-cest-merveilleux" class="section level4">
<h4><span class="header-section-number">5.4.4.5</span> Les treemaps, c’est merveilleux</h4>
<p>D’autre graphiques et des emboitements</p>
<div class="sourceCode" id="cb57"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb57-1" title="1"><span class="kw">library</span>(treemapify)</a>
<a class="sourceLine" id="cb57-2" title="2">tree1&lt;-df <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">mutate</span>(<span class="dt">n=</span><span class="dv">1</span>)<span class="op">%&gt;%</span><span class="kw">group_by</span>(cntry,genre,habitat) <span class="op">%&gt;%</span><span class="st"> </span><span class="kw">summarize</span>(<span class="dt">n=</span><span class="kw">sum</span>(n),<span class="dt">mean=</span><span class="kw">mean</span>(trust_interpersonnel, <span class="dt">na.rm=</span><span class="ot">TRUE</span>))</a>
<a class="sourceLine" id="cb57-3" title="3"></a>
<a class="sourceLine" id="cb57-4" title="4">g10 &lt;-<span class="st"> </span><span class="kw">ggplot</span>(tree1, <span class="kw">aes</span>(<span class="dt">area =</span> n, <span class="dt">fill=</span>genre,<span class="dt">subgroup=</span>cntry)) <span class="op">+</span></a>
<a class="sourceLine" id="cb57-5" title="5"><span class="st">  </span><span class="kw">geom_treemap</span>() <span class="op">+</span><span class="st">   </span></a>
<a class="sourceLine" id="cb57-6" title="6"><span class="st">  </span><span class="kw">geom_treemap_text</span>(<span class="kw">aes</span>(<span class="dt">label=</span>habitat),<span class="dt">colour =</span> <span class="st">&quot;white&quot;</span>, <span class="dt">place =</span> <span class="st">&quot;centre&quot;</span>,<span class="dt">grow =</span> <span class="ot">FALSE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb57-7" title="7"><span class="st">      </span><span class="kw">geom_treemap_subgroup_text</span>(<span class="dt">color=</span><span class="st">&quot;white&quot;</span>,<span class="dt">grow =</span> <span class="ot">FALSE</span>)<span class="op">+</span></a>
<a class="sourceLine" id="cb57-8" title="8"><span class="st">  </span><span class="kw">geom_treemap_subgroup_border</span>()</a>
<a class="sourceLine" id="cb57-9" title="9">g10</a></code></pre></div>
<p><img src="bookdown-demo_files/figure-html/330-1.png" width="672" /></p>

</div>
</div>
</div>
</div>
            </section>

          </div>
        </div>
      </div>
<a href="prise-en-main.html" class="navigation navigation-prev " aria-label="Previous page"><i class="fa fa-angle-left"></i></a>
<a href="analyse-graphique-multivariée.html" class="navigation navigation-next " aria-label="Next page"><i class="fa fa-angle-right"></i></a>
    </div>
  </div>
<script src="libs/gitbook-2.6.7/js/app.min.js"></script>
<script src="libs/gitbook-2.6.7/js/lunr.js"></script>
<script src="libs/gitbook-2.6.7/js/clipboard.min.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-search.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-sharing.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-fontsettings.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-bookdown.js"></script>
<script src="libs/gitbook-2.6.7/js/jquery.highlight.js"></script>
<script src="libs/gitbook-2.6.7/js/plugin-clipboard.js"></script>
<script>
gitbook.require(["gitbook"], function(gitbook) {
gitbook.start({
"sharing": {
"github": false,
"facebook": true,
"twitter": true,
"linkedin": false,
"weibo": false,
"instapaper": false,
"vk": false,
"whatsapp": false,
"all": ["facebook", "twitter", "linkedin", "weibo", "instapaper"]
},
"fontsettings": {
"theme": "white",
"family": "sans",
"size": 2
},
"edit": {
"link": "https://github.com/rstudio/bookdown-demo/edit/master/03-GGplotA.Rmd",
"text": "Edit"
},
"history": {
"link": null,
"text": null
},
"view": {
"link": null,
"text": null
},
"download": ["bookdown-demo.pdf", "bookdown-demo.epub"],
"toc": {
"collapse": "subsection"
}
});
});
</script>

<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    var src = "true";
    if (src === "" || src === "true") src = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-MML-AM_CHTML";
    if (location.protocol !== "file:")
      if (/^https?:/.test(src))
        src = src.replace(/^https?:/, '');
    script.src = src;
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>
</body>

</html>
